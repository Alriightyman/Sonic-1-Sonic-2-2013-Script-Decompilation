//--------------------Sonic 1 / Sonic 2 Checkered Ball Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 74: TYPE_CHECKEREDBALL

// Function declarations
#function CheckeredBall_DebugDraw
#function CheckeredBall_DebugSpawn
#function CheckeredBall_Function142
#function CheckeredBall_Function143
#function CheckeredBall_Function144
#function CheckeredBall_Function145
#function CheckeredBall_Function146
#function CheckeredBall_Function147
#function CheckeredBall_Function148



//Unknown Variables
#array CheckeredBall_array0:(0,0,0,0,1,1,1,1,2,2,3,3,4,4,5,6,7,8,9,10,12,14,16,20)
#array CheckeredBall_array1:(253,251,248,245,243,240,237,235,232,229,226,224,221,219,216,213,210,208,205,203,200,197,195,192)

function CheckeredBall_DebugDraw
	DrawSprite(1)
endfunction


function CheckeredBall_DebugSpawn
	CreateTempObject(TypeName[CheckeredBall],0,Object.XPos,Object.YPos)
	Object[TempObjectPos].Gravity=GRAVITY_AIR
	Object[TempObjectPos].Value7=Object.XPos
	Object[TempObjectPos].Value8=Object.YPos
	Object[TempObjectPos].Value1=Object.XPos
	Object[TempObjectPos].Value2=Object.YPos
endfunction


function CheckeredBall_Function142
	Object.Value10=0
	TempValue2=0
	foreach TypeGroup[256],PlayerObjectPos
		CheckEqual(options.attractMode,1)
		TempValue1=CheckResult
		CheckEqual(PlayerObjectPos,1)
		TempValue1&=CheckResult
		TempValue0=Object[PlayerObjectPos].Value21
		TempValue0>>=1
		if Object[PlayerObjectPos].Gravity==GRAVITY_GROUND
			if Object[PlayerObjectPos].XVelocity<0
				PlayerObjectCollision(C_TOUCH,Object.EntityNo,0,-22,23,22,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
				if CheckResult==1
					if Object[PlayerObjectPos].Left==1
						if TempValue1==0
							SetBit(Object.Value10,TempValue2,1)
							TempValue1=Object[PlayerObjectPos].Value20
							FlipSign(TempValue1)
							if Object.Speed>TempValue1
								Object.Speed-=TempValue0
							endif
							Object.Value6=1
						endif
						Object[PlayerObjectPos].XPos=Object[PlayerObjectPos].CollisionRight
						Object[PlayerObjectPos].XPos+=22
						Object[PlayerObjectPos].XPos<<=16
						Object[PlayerObjectPos].XPos+=Object.Value1
						if Object.XVelocity<0
							if Object[PlayerObjectPos].Speed<Object.Speed
								Object[PlayerObjectPos].XVelocity=Object.XVelocity
								Object[PlayerObjectPos].Speed=Object.Speed
							endif
						endif
						Object[PlayerObjectPos].Pushing=2
					endif
				endif
			else
				if Object[PlayerObjectPos].XVelocity>0
					PlayerObjectCollision(C_TOUCH,Object.EntityNo,-23,-22,0,22,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
					if CheckResult==1
						if Object[PlayerObjectPos].Right==1
							if TempValue1==0
								SetBit(Object.Value10,TempValue2,1)
								if Object.Speed<Object[PlayerObjectPos].Value20
									Object.Speed+=TempValue0
								endif
								Object.Value6=1
							endif
							Object[PlayerObjectPos].XPos=Object[PlayerObjectPos].CollisionLeft
							Object[PlayerObjectPos].XPos+=-22
							Object[PlayerObjectPos].XPos<<=16
							Object[PlayerObjectPos].XPos+=Object.Value1
							if Object.XVelocity>0
								if Object[PlayerObjectPos].Speed>Object.Speed
									Object[PlayerObjectPos].XVelocity=Object.XVelocity
									Object[PlayerObjectPos].Speed=Object.Speed
								endif
							endif
							Object[PlayerObjectPos].Pushing=2
						endif
					endif
				endif
			endif
		endif
		TempValue2++
	floop
endfunction


function CheckeredBall_Function143
	TempValue6=Object.XPos
	TempValue6&=-0x10000
	TempValue6-=Object.Value1
	TempValue7=Object.YPos
	TempValue7&=-0x10000
	TempValue7-=Object.Value2
	TempValue4=Object.XPos
	TempValue5=Object.YPos
	Object.XPos=Object.Value1
	Object.YPos=Object.Value2
	TempValue2=0
	foreach TypeGroup[256],PlayerObjectPos
		GetBit(TempValue0,Object.Value10,TempValue2)
		if TempValue0==1
			if Object[PlayerObjectPos].XPos<Object.XPos
				TempValue1=Object[PlayerObjectPos].CollisionRight
				FlipSign(TempValue1)
				TempValue1-=22
			else
				TempValue1=Object[PlayerObjectPos].CollisionLeft
				FlipSign(TempValue1)
				TempValue1+=22
			endif
			TempValue1<<=16
			Object[PlayerObjectPos].XPos=TempValue1
			Object[PlayerObjectPos].XPos+=TempValue4
		else
			PlayerObjectCollision(C_BOX,Object.EntityNo,-22,-22,22,22,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
			if CheckResult==1
				Object[PlayerObjectPos].XPos+=TempValue6
				TempValue0=TempValue6
				TempValue0>>=1
				Object[PlayerObjectPos].XPos+=TempValue0
				Object[PlayerObjectPos].YPos+=TempValue7
				if Object[PlayerObjectPos].XVelocity!=0
					TempValue0=Object[PlayerObjectPos].Value21
					TempValue0>>=2
					if Object[PlayerObjectPos].XVelocity>0
						FlipSign(TempValue0)
					endif
				else
					TempValue0=0
				endif
				Object.Speed+=TempValue0
				if TempValue0!=0
					Object.Value6=1
				endif
				Object.XPos=TempValue4
				Object.YPos=TempValue5
				PlayerObjectCollision(C_BOX,Object.EntityNo,-22,-22,22,22,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
				Object.XPos=Object.Value1
				Object.YPos=Object.Value2
				if CheckResult==0
					TempValue0=TempValue6
					TempValue1=TempValue6
					TempValue0>>=1
					TempValue1+=TempValue0
					Object[PlayerObjectPos].Speed+=TempValue0
					Object[PlayerObjectPos].XVelocity=Object[PlayerObjectPos].Speed
					Object[PlayerObjectPos].Gravity=GRAVITY_AIR
					Object[PlayerObjectPos].ControlLock=15
				endif
			endif
			if CheckResult==4
				if Object.YVelocity>=0
					if Object[PlayerObjectPos].Gravity==GRAVITY_GROUND
						CallFunction(PlayerObject_Kill)
					endif
				endif
			endif
		endif
		TempValue2++
	floop
	Object.XPos=TempValue4
	Object.YPos=TempValue5
endfunction


function CheckeredBall_Function144
	TempValue0=Object.XVelocity
	TempValue0|=Object.YVelocity
	if TempValue0!=0
		ResetObjectEntity(Object[ArrayPos0].EntityNo,TypeName[BlankObject],0,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
		Rand(CheckResult,32)
		if CheckResult>15
			CreateTempObject(animalType1,0,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
		else
			CreateTempObject(animalType2,0,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
		endif
		Object[TempObjectPos].Priority=PRIORITY_UNKNOWN
		CreateTempObject(TypeName[SmokePuff],0,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
		Object[TempObjectPos].DrawOrder=4
		CreateTempObject(TypeName[ObjectScore],Object.Value11,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
		Object[TempObjectPos].DrawOrder=4
		PlaySfx(SFXName[Destroy],0)
		switch Object.Value11
		case 0
			player.score+=100
			break
		case 1
			player.score+=200
			break
		case 2
			player.score+=500
			break
		case 3
		case 4
		case 5
		case 6
		case 7
		case 8
		case 9
		case 10
		case 11
		case 12
		case 13
		case 14
			player.score+=1000
			break
		case 15
			player.score+=0x2710
			break

		endswitch
		if Object.Value11<15
			Object.Value11++
		endif
	endif
endfunction


function CheckeredBall_Function145
	TempValue0=Object.XPos
	TempValue0-=Object[ArrayPos0].XPos
	TempValue1=Object.YPos
	TempValue1-=Object[ArrayPos0].YPos
	ATan2(TempValue2,TempValue0,TempValue1)
	Sin256(TempValue0,TempValue2)
	Cos256(TempValue1,TempValue2)
	Object[ArrayPos0].XVelocity=TempValue1
	Object[ArrayPos0].XVelocity*=-0x800
	Object[ArrayPos0].YVelocity=TempValue0
	Object[ArrayPos0].YVelocity*=-0x800
endfunction


function CheckeredBall_Function146
	switch Object[ArrayPos0].PropertyValue
	case 0
		TempValue0=Object[ArrayPos0].Value1
		if Object.Gravity==GRAVITY_AIR
			TempValue0=1
		endif
		if Object.CollisionMode>CMODE_FLOOR
			if Object.YVelocity<0
				TempValue0=1
			endif
		endif
		if TempValue0==0
			PlayerObjectCollision(C_BOX,Object[ArrayPos0].EntityNo,-14,-8,14,8,Object.EntityNo,-22,-22,22,22)
			PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-14,-10,14,-6,Object.EntityNo,-22,-22,22,22)
			if CheckResult==1
				Object[ArrayPos0].Value0=1
				Object.TileCollisions=1
				Object.Gravity=GRAVITY_AIR
				Object.Speed=Object.XVelocity
				Object.YVelocity=TempValue7
				FlipSign(Object.YVelocity)
				Object.YVelocity+=Object[ArrayPos0].Value2
				PlaySfx(SFXName[Spring],0)
			endif
		else
			if Object.YVelocity>=0
				PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-14,-8,14,8,Object.EntityNo,-22,-22,22,22)
				PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-14,-10,14,-6,Object.EntityNo,-22,-22,22,22)
				if CheckResult==1
					Object[ArrayPos0].Value0=1
					Object.TileCollisions=1
					Object.Gravity=GRAVITY_AIR
					Object.Speed=Object.XVelocity
					Object.YVelocity=TempValue7
					FlipSign(Object.YVelocity)
					Object.YVelocity+=Object[ArrayPos0].Value2
					PlaySfx(SFXName[Spring],0)
				endif
			endif
		endif
		break
	case 1
		PlayerObjectCollision(C_BOX,Object[ArrayPos0].EntityNo,-8,-14,8,14,Object.EntityNo,-22,-22,22,22)
		if Object.Gravity==GRAVITY_GROUND
			PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,6,-14,10,14,Object.EntityNo,-22,-22,22,22)
			if CheckResult==1
				Object[ArrayPos0].Value0=1
				Object.TileCollisions=1
				Object.Speed=TempValue7
				Object.CollisionMode=CMODE_FLOOR
				Object.Direction=FLIP_NONE
				PlaySfx(SFXName[Spring],0)
			endif
		endif
		break
	case 2
		PlayerObjectCollision(C_BOX,Object[ArrayPos0].EntityNo,-8,-14,8,14,Object.EntityNo,-22,-22,22,22)
		if Object.Gravity==GRAVITY_GROUND
			PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-10,-14,-6,14,Object.EntityNo,-22,-22,22,22)
			if CheckResult==1
				Object[ArrayPos0].Value0=1
				Object.TileCollisions=1
				Object.Speed=TempValue7
				FlipSign(Object.Speed)
				Object.CollisionMode=CMODE_FLOOR
				Object.Direction=FLIP_X
				PlaySfx(SFXName[Spring],0)
			endif
		endif
		break
	case 3
		PlayerObjectCollision(C_BOX,Object[ArrayPos0].EntityNo,-14,-8,14,8,Object.EntityNo,-22,-22,22,22)
		PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-14,6,14,10,Object.EntityNo,-22,-22,22,22)
		if CheckResult==1
			Object[ArrayPos0].Value0=1
			if Object.CollisionMode==CMODE_ROOF
				FlipSign(Object.Speed)
				FlipSign(Object.XVelocity)
			endif
			Object.TileCollisions=1
			Object.Gravity=GRAVITY_AIR
			Object.Speed=Object.XVelocity
			Object.YVelocity=TempValue7
			PlaySfx(SFXName[Spring],0)
		endif
		break

	endswitch
endfunction


function CheckeredBall_Function147
	if Object[ArrayPos0].State<3
		if Object.YVelocity>=0
			TempValue0=Object.XPos
			TempValue0-=Object[ArrayPos0].XPos
			TempValue0>>=17
			TempValue0+=24
			if TempValue0<0
				TempValue0=0
			endif
			if TempValue0>47
				TempValue0=47
			endif
			if TempValue7==0
				GetArrayValue(TempValue1,TempValue0,CheckeredBall_array0)
			else
				TempValue2=47
				TempValue2-=TempValue0
				GetArrayValue(TempValue1,TempValue2,CheckeredBall_array0)
			endif
			TempValue1-=84
			TempValue0=TempValue1
			TempValue0+=32
			PlayerObjectCollision(C_PLATFORM,ArrayPos0,-48,TempValue1,48,TempValue0,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object.YPos+=0x40000
				if Object[ArrayPos0].State==0
					Object[ArrayPos0].State=1
				endif
			endif
		endif
	endif
endfunction


function CheckeredBall_Function148
	if Object.Gravity==GRAVITY_AIR
		Object.YVelocity+=0x3800
		Object.Speed=Object.XVelocity
	else
		Sin256(TempValue0,Object.Value4)
		TempValue0*=0x2000
		TempValue0>>=8
		Object.Speed+=TempValue0
		Object.Value5=Object.Speed
		if TempValue0==0
			if Object.Value6==0
				if Object.Speed>0
					Object.Speed-=0x400
					if Object.Speed<0
						Object.Speed=0
					endif
				else
					Object.Speed+=0x400
					if Object.Speed>0
						Object.Speed=0
					endif
				endif
			endif
		endif
		Cos256(TempValue0,Object.Value4)
		TempValue0*=Object.Speed
		TempValue0>>=8
		Object.XVelocity=TempValue0
		Sin256(TempValue0,Object.Value4)
		TempValue0*=Object.Speed
		TempValue0>>=8
		Object.YVelocity=TempValue0
	endif
	Object.Value6=0
endfunction


sub ObjectMain
	if Object.Priority!=PRIORITY_XBOUNDS_DESTROY
		Object.Priority=PRIORITY_ACTIVE
	endif
	CallFunction(CheckeredBall_Function142)
	Object.Value3+=Object.Value5
	Object.CollisionLeft=-22
	Object.CollisionTop=-22
	Object.CollisionRight=22
	Object.CollisionBottom=22
	CallFunction(CheckeredBall_Function148)
	PlayerTileCollision()
	Object.Value4=Object.Angle
	foreach TypeGroup[0],ArrayPos0
		switch Object[ArrayPos0].Type
		case 58
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-14,-14,14,14)
			if CheckResult==1
				CallFunction(CheckeredBall_Function144)
			endif
			break
		case 56
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-16,-7,16,7)
			if CheckResult==1
				CallFunction(CheckeredBall_Function144)
			endif
			break
		case 61
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-14,-14,14,14)
			if CheckResult==1
				CallFunction(CheckeredBall_Function144)
			endif
			break
		case 60
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-12,-14,12,14)
			if CheckResult==1
				CallFunction(CheckeredBall_Function144)
			endif
			break
		case 73
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-10,-20,6,20)
			if CheckResult==1
				CallFunction(CheckeredBall_Function144)
			endif
			break
		case 65
			switch Object[ArrayPos0].State
			case 2
			case 3
				PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-16,-8,16,8)
				if CheckResult==1
					CallFunction(CheckeredBall_Function144)
				endif
				break

			endswitch
			break
		case 63
			switch Object[ArrayPos0].State
			case 2
			case 3
				PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-12,-14,12,14)
				if CheckResult==1
					CallFunction(CheckeredBall_Function144)
				endif
				break

			endswitch
			break
		case 57
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-6,-6,6,6)
			if CheckResult==1
				CallFunction(CheckeredBall_Function145)
			endif
			break
		case 62
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-6,-6,6,6)
			if CheckResult==1
				CallFunction(CheckeredBall_Function145)
			endif
			break
		case 64
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-6,-6,6,6)
			if CheckResult==1
				CallFunction(CheckeredBall_Function145)
			endif
			break
		case 13
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-22,-22,22,22,ArrayPos0,-16,-14,16,16)
			if CheckResult==1
				Object[ArrayPos0].State=0
				CreateTempObject(TypeName[SmokePuff],0,Object[ArrayPos0].XPos,Object[ArrayPos0].YPos)
				Object[TempObjectPos].DrawOrder=4
				Object[ArrayPos0].Type=TypeName[BrokenMonitor]
				if Object[ArrayPos0].Priority!=PRIORITY_XBOUNDS_DESTROY
					Object[ArrayPos0].Priority=PRIORITY_ACTIVE
				endif
				Object[ArrayPos0].Alpha=255
				Object[ArrayPos0].Value0=Object[ArrayPos0].YPos
				Object[ArrayPos0].Value1=-0x30000
				PlaySfx(SFXName[Destroy],0)
			endif
			break
		case 43
			PlayerObjectCollision(C_BOX,ArrayPos0,-16,-16,16,16,Object.EntityNo,-22,-22,22,22)
			switch CheckResult
			case 1
				Object.Gravity=GRAVITY_GROUND
				break
			case 2
				if Object.Speed>0
					Object.Speed=0
				endif
				break
			case 3
				if Object.Speed<0
					Object.Speed=0
				endif
				break

			endswitch
			break
		case 35
			switch Object[ArrayPos0].PropertyValue
			case 0
				PlayerObjectCollision(C_BOX,ArrayPos0,-20,-16,20,16,Object.EntityNo,-22,-22,22,22)
				break
			case 1
				PlayerObjectCollision(C_BOX,ArrayPos0,-16,-20,15,20,Object.EntityNo,-22,-22,22,22)
				break
			case 2
				PlayerObjectCollision(C_BOX,ArrayPos0,-15,-20,16,20,Object.EntityNo,-22,-22,22,22)
				break
			case 3
				PlayerObjectCollision(C_BOX,ArrayPos0,-20,-16,20,15,Object.EntityNo,-22,-22,22,22)
				break
			case 4
				PlayerObjectCollision(C_BOX,ArrayPos0,-4,-16,4,16,Object.EntityNo,-22,-22,22,22)
				break
			case 5
				PlayerObjectCollision(C_BOX,ArrayPos0,-16,-4,15,4,Object.EntityNo,-22,-22,22,22)
				break
			case 6
				PlayerObjectCollision(C_BOX,ArrayPos0,-15,-4,16,4,Object.EntityNo,-22,-22,22,22)
				break
			case 7
				PlayerObjectCollision(C_BOX,ArrayPos0,-4,-16,4,15,Object.EntityNo,-22,-22,22,22)
				break
			case 8
				PlayerObjectCollision(C_BOX,ArrayPos0,-28,-16,28,16,Object.EntityNo,-22,-22,22,22)
				break
			case 9
				PlayerObjectCollision(C_BOX,ArrayPos0,-16,-28,15,28,Object.EntityNo,-22,-22,22,22)
				break
			case 10
				PlayerObjectCollision(C_BOX,ArrayPos0,-15,-28,16,28,Object.EntityNo,-22,-22,22,22)
				break
			case 11
				PlayerObjectCollision(C_BOX,ArrayPos0,-28,-16,28,15,Object.EntityNo,-22,-22,22,22)
				break
			case 12
				PlayerObjectCollision(C_BOX,ArrayPos0,-64,-16,64,16,Object.EntityNo,-22,-22,22,22)
				break
			case 13
				PlayerObjectCollision(C_BOX,ArrayPos0,-16,-64,15,64,Object.EntityNo,-22,-22,22,22)
				break
			case 14
				PlayerObjectCollision(C_BOX,ArrayPos0,-15,-64,16,64,Object.EntityNo,-22,-22,22,22)
				break
			case 15
				PlayerObjectCollision(C_BOX,ArrayPos0,-64,-16,64,15,Object.EntityNo,-22,-22,22,22)
				break

			endswitch
			switch CheckResult
			case 1
				Object.Gravity=GRAVITY_GROUND
				break
			case 2
				if Object.Speed>0
					Object.Speed=0
				endif
				break
			case 3
				if Object.Speed<0
					Object.Speed=0
				endif
				break

			endswitch
			break
		case 51
			if Object[ArrayPos0].PropertyValue<3
				TempValue0=Object.Speed
				Absolute(TempValue0)
				if TempValue0>=0x20000
					PlayerObjectCollision(C_TOUCH,ArrayPos0,-17,-32,17,32,Object.EntityNo,-22,-22,22,22)
					if CheckResult==1
						Object[ArrayPos0].Type=TypeName[BlankObject]
						PlaySfx(SFXName[Jump],0)
						TempValue0=Object[ArrayPos0].PropertyValue
						TempValue0<<=1
						TempValue0+=3
						TempValue1=TempValue0
						TempValue1++
						TempValue2=Object[ArrayPos0].XPos
						TempValue2-=0x80000
						TempValue3=Object[ArrayPos0].XPos
						TempValue3+=0x80000
						TempValue4=Object[ArrayPos0].YPos
						TempValue4-=0x180000
						if Object.XPos<Object[ArrayPos0].XPos
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=-0x60000
							Object[TempObjectPos].YVelocity=-0x60000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=-0x40000
							Object[TempObjectPos].YVelocity=-0x50000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=-0x80000
							Object[TempObjectPos].YVelocity=-0x20000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=-0x60000
							Object[TempObjectPos].YVelocity=-0x10000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=-0x80000
							Object[TempObjectPos].YVelocity=0x20000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=-0x60000
							Object[TempObjectPos].YVelocity=0x10000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=-0x60000
							Object[TempObjectPos].YVelocity=0x60000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=-0x40000
							Object[TempObjectPos].YVelocity=0x50000
							Object[TempObjectPos].DrawOrder=4
						else
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=0x40000
							Object[TempObjectPos].YVelocity=-0x50000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=0x60000
							Object[TempObjectPos].YVelocity=-0x60000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=0x60000
							Object[TempObjectPos].YVelocity=-0x10000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=0x80000
							Object[TempObjectPos].YVelocity=-0x20000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=0x60000
							Object[TempObjectPos].YVelocity=0x10000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=0x80000
							Object[TempObjectPos].YVelocity=0x20000
							Object[TempObjectPos].DrawOrder=4
							TempValue4+=0x100000
							CreateTempObject(TypeName[BreakableWall],TempValue0,TempValue2,TempValue4)
							Object[TempObjectPos].XVelocity=0x40000
							Object[TempObjectPos].YVelocity=0x50000
							Object[TempObjectPos].DrawOrder=4
							CreateTempObject(TypeName[BreakableWall],TempValue1,TempValue3,TempValue4)
							Object[TempObjectPos].XVelocity=0x60000
							Object[TempObjectPos].YVelocity=0x60000
							Object[TempObjectPos].DrawOrder=4
						endif
					endif
				else
					PlayerObjectCollision(C_BOX,ArrayPos0,-17,-32,17,32,Object.EntityNo,-22,-22,22,22)
					switch CheckResult
					case 1
						Object.Gravity=GRAVITY_GROUND
						break
					case 2
						if Object.Speed>0
							Object.Speed=0
						endif
						break
					case 3
						if Object.Speed<0
							Object.Speed=0
						endif
						break

					endswitch
				endif
			endif
			break
		case 44
			if Object.XPos>Object[ArrayPos0].Value6
				if Object.XPos<Object[ArrayPos0].Value7
					if Object.EntityNo==Object[ArrayPos0].Value5
						Object[ArrayPos0].Value2=Object.XPos
						Object[ArrayPos0].Value2-=Object[ArrayPos0].Value6
						TempValue0=Object[ArrayPos0].Value2
						TempValue0>>=8
						TempValue1=Object[ArrayPos0].Value7
						TempValue1-=Object[ArrayPos0].Value6
						TempValue2=TempValue1
						TempValue2>>=16
						TempValue0/=TempValue2
						Sin(Object[ArrayPos0].Value3,TempValue0)
						TempValue1>>=13
						Object[ArrayPos0].Value3*=TempValue1
						TempValue0=Object[ArrayPos0].YPos
						TempValue0-=0x300000
						if Object.YPos>TempValue0
							if Object.YVelocity>=0
								TempValue2=Object.CollisionBottom
								FlipSign(TempValue2)
								TempValue2<<=16
								TempValue2+=Object[ArrayPos0].Value4
								TempValue2-=0x80000
								Object[ArrayPos0].Value0++
								Object.YPos=Object[ArrayPos0].YPos
								Object.YPos+=TempValue2
								Object.Gravity=GRAVITY_GROUND
								Object.YVelocity=0
								Object.Flailing0=1
								Object.Flailing1=1
								Object.Flailing2=1
							else
								Object[ArrayPos0].Value5=-2
							endif
						endif
					else
						if Object.YVelocity>=0
							TempValue0=Object.XPos
							TempValue0-=Object[ArrayPos0].Value6
							if TempValue0>Object[ArrayPos0].Value2
								TempValue0=Object[ArrayPos0].Value7
								TempValue0-=Object.XPos
								TempValue3=Object[ArrayPos0].Value7
								TempValue3-=Object[ArrayPos0].Value6
								TempValue3-=Object[ArrayPos0].Value2
								TempValue1=TempValue0
								TempValue1<<=7
								TempValue1/=TempValue3
							else
								TempValue1=TempValue0
								TempValue1<<=7
								TempValue1/=Object[ArrayPos0].Value2
							endif
							Sin(TempValue2,TempValue1)
							TempValue2*=Object[ArrayPos0].Value4
							TempValue2>>=9
							TempValue2-=0x80000
							if Object.YVelocity<0x8000
								TempValue3=TempValue2
								TempValue3>>=16
								TempValue4=TempValue3
								TempValue3-=8
							else
								TempValue3=TempValue2
								TempValue3>>=16
								TempValue4=TempValue3
								TempValue4+=8
							endif
							PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-0x400,TempValue3,0x400,TempValue4,Object.EntityNo,-18,-22,18,22)
							if CheckResult==1
								Object[ArrayPos0].Value0++
								Object.YPos=Object.CollisionBottom
								FlipSign(Object.YPos)
								Object.YPos<<=16
								Object.YPos+=Object[ArrayPos0].YPos
								Object.YPos+=TempValue2
								Object.Flailing0=1
								Object.Flailing1=1
								Object.Flailing2=1
								Object[ArrayPos0].Value5=Object.EntityNo
								Object.Gravity=GRAVITY_GROUND
								Object.YVelocity=0
							endif
						endif
					endif
				else
					if Object.EntityNo==Object[ArrayPos0].Value5
						Object[ArrayPos0].Value5=-2
						Object[ArrayPos0].Value1=32
					endif
				endif
			else
				if Object.EntityNo==Object[ArrayPos0].Value5
					Object[ArrayPos0].Value5=-2
					Object[ArrayPos0].Value1=32
				endif
			endif
			break
		case 16
			TempValue7=0xA0000
			CallFunction(CheckeredBall_Function146)
			break
		case 15
			TempValue7=0x100000
			CallFunction(CheckeredBall_Function146)
			break
		case 47
			Object[ArrayPos0].YPos-=Object[ArrayPos0].Value1
			PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-32,-8,32,0,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object[ArrayPos0].Value0=1
				Object.Value13=Object[ArrayPos0].Value1
			endif
			Object[ArrayPos0].YPos+=Object[ArrayPos0].Value1
			break
		case 48
			Object[ArrayPos0].XPos-=Object[ArrayPos0].Value3
			Object[ArrayPos0].YPos-=Object[ArrayPos0].Value4
			PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-32,-8,32,12,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object[ArrayPos0].Value0=1
				Object.Value12=Object[ArrayPos0].Value3
				Object.Value13=Object[ArrayPos0].Value4
			endif
			Object[ArrayPos0].XPos+=Object[ArrayPos0].Value3
			Object[ArrayPos0].YPos+=Object[ArrayPos0].Value4
			break
		case 49
			Object[ArrayPos0].YPos-=Object[ArrayPos0].Value1
			PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-32,-8,32,12,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object.Value13=Object[ArrayPos0].Value1
			endif
			Object[ArrayPos0].YPos+=Object[ArrayPos0].Value1
			break
		case 50
			Object[ArrayPos0].YPos-=Object[ArrayPos0].Value1
			PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-32,-2,32,12,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object.Value13=Object[ArrayPos0].Value1
			endif
			Object[ArrayPos0].YPos+=Object[ArrayPos0].Value1
			break
		case 46
			TempValue0=Object[ArrayPos0].XPos
			TempValue1=Object[ArrayPos0].YPos
			Object[ArrayPos0].XPos=Object[ArrayPos0].Value1
			Object[ArrayPos0].YPos=Object[ArrayPos0].Value2
			Object[ArrayPos0].XPos-=Object[ArrayPos0].Value3
			Object[ArrayPos0].YPos-=Object[ArrayPos0].Value4
			PlayerObjectCollision(C_PLATFORM,Object[ArrayPos0].EntityNo,-24,-8,24,8,Object.EntityNo,-18,-22,18,22)
			if CheckResult==1
				Object.Value12=Object[ArrayPos0].Value3
				Object.Value13=Object[ArrayPos0].Value4
			endif
			Object[ArrayPos0].XPos=TempValue0
			Object[ArrayPos0].YPos=TempValue1
			break
		case 52
			TempValue7=1
			CallFunction(CheckeredBall_Function147)
			break
		case 53
			TempValue7=0
			CallFunction(CheckeredBall_Function147)
			break
		case 40
			CheckEqual(Object[ArrayPos0].Value6,0)
			TempValue0=CheckResult
			CheckEqual(Object.Gravity,GRAVITY_GROUND)
			TempValue0|=CheckResult
			if TempValue0==1
				PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,-12,Object[ArrayPos0].Value0,12,Object[ArrayPos0].Value1,Object.EntityNo,-10,-22,10,22)
				if CheckResult==1
					if Object.XVelocity>0
						Object.CollisionPlane=Object[ArrayPos0].Value3
						Object.DrawOrder=Object[ArrayPos0].Value5
					else
						Object.CollisionPlane=Object[ArrayPos0].Value2
						Object.DrawOrder=Object[ArrayPos0].Value4
					endif
				endif
			endif
			break
		case 41
			CheckEqual(Object[ArrayPos0].Value6,0)
			TempValue0=CheckResult
			CheckEqual(Object.Gravity,GRAVITY_GROUND)
			TempValue0|=CheckResult
			if TempValue0==1
				PlayerObjectCollision(C_TOUCH,Object[ArrayPos0].EntityNo,Object[ArrayPos0].Value0,-12,Object[ArrayPos0].Value1,12,Object.EntityNo,-22,-10,22,10)
				if CheckResult==1
					if Object.YVelocity>0
						Object.CollisionPlane=Object[ArrayPos0].Value3
						Object.DrawOrder=Object[ArrayPos0].Value5
					else
						Object.CollisionPlane=Object[ArrayPos0].Value2
						Object.DrawOrder=Object[ArrayPos0].Value4
					endif
				endif
			endif
			break
		case 66
			ArrayPos1=ArrayPos0
			ArrayPos1--
			if Object[ArrayPos1].Value4==0
				switch Object[ArrayPos0].State
				case 4
				case 5
				case 6
					PlayerObjectCollision(C_TOUCH,ArrayPos0,-20,-16,20,16,Object.EntityNo,-22,-22,22,22)
					if CheckResult==1
						Object[ArrayPos0].Value1--
						if Object[ArrayPos0].Value1==0
							player.score+=1000
							Object[ArrayPos0].AnimationTimer=0
							Object[ArrayPos0].Animation=4
							Object[ArrayPos1].State=2
							Object[ArrayPos1].Value6=0
							ArrayPos1--
							ResetObjectEntity(ArrayPos1,TypeName[Explosion],0,Object[ArrayPos1].XPos,Object[ArrayPos1].YPos)
							ArrayPos1--
							ResetObjectEntity(ArrayPos1,TypeName[Explosion],0,Object[ArrayPos1].XPos,Object[ArrayPos1].YPos)
							ArrayPos1--
							ResetObjectEntity(ArrayPos1,TypeName[Explosion],0,Object[ArrayPos1].XPos,Object[ArrayPos1].YPos)
							ArrayPos1--
							ResetObjectEntity(ArrayPos1,TypeName[Explosion],0,Object[ArrayPos1].XPos,Object[ArrayPos1].YPos)
							ArrayPos1--
							ResetObjectEntity(ArrayPos1,TypeName[Explosion],0,Object[ArrayPos1].XPos,Object[ArrayPos1].YPos)
							Object[ArrayPos0].Value0=0
							Object[ArrayPos0].State=7
						else
							Object[ArrayPos0].AnimationTimer=0
							Object[ArrayPos0].Animation=3
							Object[ArrayPos1].Value4=32
							PlaySfx(SFXName[BossHit],0)
						endif
					endif
					break

				endswitch
			endif
			break
		case 69
			if Object[ArrayPos0].State==1
				PlayerObjectCollision(C_TOUCH,ArrayPos0,-22,-22,22,22,Object.EntityNo,-22,-22,22,22)
				if CheckResult==1
					TempValue0=Object[ArrayPos0].XPos
					TempValue0-=Object.Value14
					TempValue1=Object[ArrayPos0].YPos
					TempValue1-=Object.Value15
					if Object.XVelocity==0
						Object.XVelocity=TempValue0
						Object.Speed=Object.XVelocity
					else
						if Object.XVelocity<0
							if TempValue0>0
								TempValue2=TempValue0
								TempValue2>>=1
								TempValue0+=TempValue2
								Object.XVelocity=TempValue0
								Object.Speed=Object.XVelocity
							endif
						else
							if TempValue0<0
								TempValue2=TempValue0
								TempValue2>>=1
								TempValue0+=TempValue2
								Object.XVelocity=TempValue0
								Object.Speed=Object.XVelocity
							endif
						endif
					endif
					if Object.YVelocity==0
						Object.YVelocity=TempValue1
					else
						if Object.YVelocity<0
							if TempValue1>0
								TempValue2=TempValue1
								TempValue2>>=1
								TempValue1+=TempValue2
								Object.YVelocity=TempValue1
							endif
						else
							if TempValue1<0
								TempValue2=TempValue1
								TempValue2>>=1
								TempValue1+=TempValue2
								Object.YVelocity=TempValue1
							endif
						endif
					endif
				endif
			endif
			Object.Value14=Object[ArrayPos0].XPos
			Object.Value15=Object[ArrayPos0].YPos
			break
		case 74
			if ArrayPos0!=Object.EntityNo
				TempValue0=Object.XPos
				TempValue0-=Object[ArrayPos0].XPos
				Absolute(TempValue0)
				TempValue0>>=17
				if TempValue0>=24
					TempValue0=23
				endif
				GetArrayValue(TempValue6,TempValue0,CheckeredBall_array1)
				TempValue0=TempValue6
				TempValue0>>=1
				TempValue6+=TempValue0
				TempValue6-=22
				TempValue7=TempValue6
				FlipSign(TempValue7)
				TempValue0=Object.XVelocity
				TempValue1=Object.YVelocity
				TempValue2=Object.Speed
				PlayerObjectCollision(C_BOX,ArrayPos0,-22,TempValue6,22,TempValue7,Object.EntityNo,-22,-22,22,22)
				switch CheckResult
				case 2
				case 3
					CheckGreater(TempValue0,0)
					TempValue3=CheckResult
					CheckLower(Object.XPos,Object[ArrayPos0].XPos)
					TempValue3&=CheckResult
					CheckLower(TempValue0,0)
					TempValue4=CheckResult
					CheckGreater(Object.XPos,Object[ArrayPos0].XPos)
					TempValue4&=CheckResult
					TempValue3|=TempValue4
					if TempValue3!=0
						Object.XVelocity=Object[ArrayPos0].XVelocity
						Object.Speed=Object[ArrayPos0].Speed
						Object[ArrayPos0].XVelocity=TempValue0
						Object[ArrayPos0].Speed=TempValue2
					endif
					break
				case 1
					if Object.XPos<Object[ArrayPos0].XPos
						Object.Speed-=0xC00
						Object.XVelocity-=0xC00
						Object[ArrayPos0].Speed+=0xC00
						Object[ArrayPos0].XVelocity+=0xC00
						Object[ArrayPos0].Value5+=0xC00
					else
						Object.Speed+=0xC00
						Object.XVelocity+=0xC00
						Object[ArrayPos0].Speed-=0xC00
						Object[ArrayPos0].XVelocity-=0xC00
						Object[ArrayPos0].Value5-=0xC00
					endif
					CheckGreater(TempValue1,0)
					TempValue3=CheckResult
					CheckLower(Object.YPos,Object[ArrayPos0].YPos)
					TempValue3&=CheckResult
					CheckLower(TempValue1,0)
					TempValue4=CheckResult
					CheckGreater(Object.YPos,Object[ArrayPos0].YPos)
					TempValue4&=CheckResult
					TempValue3|=TempValue4
					if TempValue3!=0
						Object.YVelocity=Object[ArrayPos0].YVelocity
						Object[ArrayPos0].YVelocity=TempValue1
					endif
					break
				case 4
					CheckGreater(TempValue1,0)
					TempValue3=CheckResult
					CheckLower(Object.YPos,Object[ArrayPos0].YPos)
					TempValue3&=CheckResult
					CheckLower(TempValue1,0)
					TempValue4=CheckResult
					CheckGreater(Object.YPos,Object[ArrayPos0].YPos)
					TempValue4&=CheckResult
					TempValue3|=TempValue4
					if TempValue3!=0
						Object.YVelocity=Object[ArrayPos0].YVelocity
						Object[ArrayPos0].YVelocity=TempValue1
					endif
					break

				endswitch
				PlayerObjectCollision(C_TOUCH,ArrayPos0,-22,TempValue6,22,TempValue7,Object.EntityNo,-22,-22,22,22)
				if CheckResult==1
					if Object.XPos<Object[ArrayPos0].XPos
						Object.XPos-=0x10000
					else
						Object.XPos+=0x10000
					endif
					if Object.YPos<Object[ArrayPos0].YPos
						Object.YPos-=0x10000
					else
						Object.YPos+=0x10000
					endif
				endif
			endif
			break
		case 21
			switch Object[ArrayPos0].State
			case 0
				PlayerObjectCollision(C_BOX,ArrayPos0,-32,-24,32,32,Object.EntityNo,-18,-22,18,22)
				PlayerObjectCollision(C_BOX,ArrayPos0,-11,-48,11,-24,Object.EntityNo,-18,-22,18,22)
				if CheckResult==1
					Object[ArrayPos0].State=1
					Stage.TimeEnabled=0
					if PlayerObject_SuperState==1
						PlayerObject_SuperState=2
					endif
					Object[0].ControlMode=-1
				endif
				break
			case 1
				PlayerObjectCollision(C_BOX,ArrayPos0,-32,-24,32,32,Object.EntityNo,-18,-22,18,22)
				PlayerObjectCollision(C_BOX,ArrayPos0,-11,-40,11,-24,Object.EntityNo,-18,-22,18,22)
				break

			endswitch
			break

		endswitch
	floop
	CallFunction(CheckeredBall_Function143)
	TempValue0=Object.Value12
	TempValue0|=Object.Value13
	if TempValue0!=0
		foreach TypeGroup[256],PlayerObjectPos
			PlayerObjectCollision(C_BOX,Object.EntityNo,-22,-22,22,22,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
			if CheckResult==1
				Object[PlayerObjectPos].XPos+=Object.Value12
				Object[PlayerObjectPos].YPos+=Object.Value13
			endif
		floop
		Object.XPos+=Object.Value12
		Object.YPos+=Object.Value13
		Object.Value12=0
		Object.Value13=0
	endif
	if Object.OutOfBounds==1
		TempValue0=Object.XPos
		TempValue1=Object.YPos
		Object.XPos=Object.Value7
		Object.YPos=Object.Value8
		if Object.OutOfBounds==1
			Object.Value1=Object.XPos
			Object.Value2=Object.YPos
			Object.XVelocity=0
			Object.YVelocity=0
			Object.Speed=0
			Object.Value11=0
			Object.Value4=0
			Object.Value10=0
			Object.Value3=0
			Object.Value5=0
			Object.Value6=0
			if Object.Priority!=PRIORITY_XBOUNDS_DESTROY
				Object.Priority=PRIORITY_ACTIVE_BOUNDS
			endif
			Object.State=0
		else
			Object.XPos=TempValue0
			Object.YPos=TempValue1
		endif
	endif
	Object.Value1=Object.XPos
	Object.Value1&=-0x10000
	Object.Value2=Object.YPos
	Object.Value2&=-0x10000
endsub


sub ObjectDraw
	Object.Rotation=Object.Value3
	Object.Rotation>>=14
	TempValue0=Object.Rotation
	TempValue0+=8
	TempValue0>>=4
	TempValue0&=7
	TempValue0++
	DrawSprite(TempValue0)
	Object.InkEffect=INK_ADD
	Object.Alpha=160
	DrawSpriteFX(0,FX_INK,Object.XPos,Object.YPos)
endsub


sub ObjectStartup
	LoadSpriteSheet("GHZ/Objects2.gif")
	SpriteFrame(-24,-24,48,48,1,77)
	SpriteFrame(-24,-24,48,48,50,77)
	SpriteFrame(-24,-24,48,48,148,126)
	SpriteFrame(-24,-24,48,48,99,126)
	SpriteFrame(-24,-24,48,48,50,126)
	SpriteFrame(-24,-24,48,48,1,126)
	SpriteFrame(-24,-24,48,48,197,77)
	SpriteFrame(-24,-24,48,48,148,77)
	SpriteFrame(-24,-24,48,48,99,77)
	LoadAnimation("WreckingBall.ani")
	foreach TypeName[CheckeredBall],ArrayPos0
		Object[ArrayPos0].Gravity=GRAVITY_AIR
		Object[ArrayPos0].Value7=Object.XPos
		Object[ArrayPos0].Value8=Object.YPos
	floop
	SetArrayValue(TypeName[Checkered Ball],DebugMode_DebugItemCount,DebugMode_DebugTypeList)
	SetArrayValue(CheckeredBall_DebugDraw,DebugMode_DebugItemCount,DebugMode_DebugDrawList)
	SetArrayValue(CheckeredBall_DebugSpawn,DebugMode_DebugItemCount,DebugMode_DebugSpawnList)
	DebugMode_DebugItemCount++
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
