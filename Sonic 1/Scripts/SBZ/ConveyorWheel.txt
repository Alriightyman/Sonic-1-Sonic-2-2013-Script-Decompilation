//--------------------Sonic 1 / Sonic 2 Conveyor Wheel Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 71: TYPE_CONVEYORWHEEL

// Function declarations
#function ConveyorWheel_DebugDraw
#function ConveyorWheel_DebugSpawn



function ConveyorWheel_DebugDraw
	DrawSprite(0)
endfunction


function ConveyorWheel_DebugSpawn
	CreateTempObject(TypeName[ConveyorWheel],0,Object.XPos,Object.YPos)
	Object[TempObjectPos].DrawOrder=5
endfunction


sub ObjectMain
	foreach TypeGroup[256],PlayerObjectPos
		PlayerObjectCollision(C_TOUCH,Object.EntityNo,-64,-64,64,64,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
		if CheckResult==1
			if Object[PlayerObjectPos].Gravity==GRAVITY_GROUND
				if Object[PlayerObjectPos].State==PlayerObject_KnuxGlideSlide
					Object[PlayerObjectPos].State=PlayerObject_HandleGround
				endif
				if Object[PlayerObjectPos].State==PlayerObject_KnuxGlideDrop
					Object[PlayerObjectPos].State=PlayerObject_HandleGround
				endif
				if Object[PlayerObjectPos].Speed<0x40000
					Object[PlayerObjectPos].Speed=0x40000
				else
					if Object[PlayerObjectPos].Speed>0xF0000
						Object[PlayerObjectPos].Speed=0xF0000
					endif
				endif
			endif
		endif
	floop
	Object.Angle+=4
	Object.Angle&=511
endsub


sub ObjectDraw
	Cos(TempValue0,Object.Angle)
	TempValue0*=0xC00
	TempValue0+=Object.XPos
	Sin(TempValue1,Object.Angle)
	TempValue1*=0xC00
	TempValue1+=Object.YPos
	DrawSpriteXY(0,TempValue0,TempValue1)
endsub


sub ObjectStartup
	LoadSpriteSheet("SBZ/Objects.gif")
	SpriteFrame(-7,-7,14,14,65,123)
	foreach TypeName[ConveyorWheel],ArrayPos0
		Object[ArrayPos0].DrawOrder=5
	floop
	SetArrayValue(TypeName[ConveyorWheel],DebugMode_DebugItemCount,DebugMode_DebugTypeList)
	SetArrayValue(ConveyorWheel_DebugDraw,DebugMode_DebugItemCount,DebugMode_DebugDrawList)
	SetArrayValue(ConveyorWheel_DebugSpawn,DebugMode_DebugItemCount,DebugMode_DebugSpawnList)
	DebugMode_DebugItemCount++
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
