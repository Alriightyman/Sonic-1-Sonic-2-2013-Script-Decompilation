//--------------------Sonic 1 / Sonic 2 H Block Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 55: TYPE_HBLOCK

// Function declarations
#function HBlock_Function119
#function HBlock_DebugSpawn

#static 0:HBlock_staticVar31


function HBlock_Function119
	DrawSprite(0)
endfunction


function HBlock_DebugSpawn
	CreateTempObject(TypeName[HBlock],Object.Direction,Object.XPos,Object.YPos)
	TempValue0=Object[0].Value17
	TempValue0-=HBlock_staticVar31
	if TempValue0==0
		if Object.Direction==FLIP_NONE
			Object[TempObjectPos].Value0=0x2000
		else
			Object[TempObjectPos].Value0=-0x2000
		endif
	else
		if Object.Direction==FLIP_NONE
			Object[TempObjectPos].Value0=0x1000
		else
			Object[TempObjectPos].Value0=-0x1000
		endif
	endif
endfunction


sub ObjectMain
	Object.Angle=SYZSetup_staticVar30
	Object.Angle*=512
	Object.Angle/=356
	Sin(Object.Value2,Object.Angle)
	Object.Value2*=Object.Value0
	Object.Value2+=Object.XPos
	Object.Value2&=-0x10000
	Object.Value2-=Object.Value1
	foreach TypeGroup[256],PlayerObjectPos
		TempValue0=Object.XPos
		Object.XPos=Object.Value1
		TempValue1=Object[PlayerObjectPos].Gravity
		PlayerObjectCollision(C_BOX,Object.EntityNo,-16,-16,16,16,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
		if CheckResult==1
			if TempValue1==1
				Object[PlayerObjectPos].XPos+=Object.Value2
			endif
		endif
		Object.XPos=TempValue0
	floop
endsub


sub ObjectDraw
	Sin(Object.Value1,Object.Angle)
	Object.Value1*=Object.Value0
	Object.Value1+=Object.XPos
	Object.Value1&=-0x10000
	DrawSpriteXY(0,Object.Value1,Object.YPos)
endsub


sub ObjectStartup
	LoadSpriteSheet("SYZ/Objects.gif")
	SpriteFrame(-16,-16,32,32,119,34)
	foreach TypeName[HBlock],ArrayPos0
		switch Object[ArrayPos0].PropertyValue
		case 0
			Object[ArrayPos0].Value0=0x2000
			break
		case 1
			Object[ArrayPos0].Value0=0x1000
			break
		case 2
			Object[ArrayPos0].Value0=-0x1000
			break
		case 3
			Object[ArrayPos0].Value0=-0x2000
			break

		endswitch
	floop
	TempValue0=0
	HBlock_staticVar31=DebugMode_DebugItemCount
	while TempValue0<2
		SetArrayValue(TypeName[HBlock],DebugMode_DebugItemCount,DebugMode_DebugTypeList)
		SetArrayValue(HBlock_DebugDraw,DebugMode_DebugItemCount,DebugMode_DebugDrawList)
		SetArrayValue(HBlock_DebugSpawn,DebugMode_DebugItemCount,DebugMode_DebugSpawnList)
		DebugMode_DebugItemCount++
		TempValue0++
	loop
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
