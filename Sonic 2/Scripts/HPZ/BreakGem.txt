//--------------------Sonic 1 / Sonic 2 Break Gem Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 59: TYPE_BREAKGEM

// Function declarations
#function BreakGem_Function129
#function BreakGem_Function130



function BreakGem_Function129
	DrawSprite(0)
endfunction


function BreakGem_Function130
	CreateTempObject(TypeName[BreakGem],0,Object.XPos,Object.YPos)
endfunction


sub ObjectMain
	switch Object.State
	case 0
		Object.InkEffect=INK_ALPHA
		TempValue0=oscillation
		TempValue0<<=4
		Sin(TempValue1,TempValue0)
		TempValue1>>=5
		TempValue1+=224
		Object.Alpha=TempValue1
		foreach TypeGroup[256],PlayerObjectPos
			if Object[PlayerObjectPos].Animation==ANI_JUMPING
				PlayerObjectCollision(C_BOX,Object.EntityNo,-16,-16,16,16,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
				if CheckResult==1
					Object[PlayerObjectPos].YVelocity=-0x30000
					Object[PlayerObjectPos].Gravity=GRAVITY_AIR
					CreateTempObject(TypeName[BreakGem],6,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=24
					Object[TempObjectPos].iYPos+=8
					Object[TempObjectPos].XVelocity=-0x18000
					Object[TempObjectPos].YVelocity=-0x1C000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],7,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=8
					Object[TempObjectPos].iYPos+=8
					Object[TempObjectPos].XVelocity=-0xC000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],8,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=8
					Object[TempObjectPos].iYPos+=8
					Object[TempObjectPos].XVelocity=0xC000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],9,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=24
					Object[TempObjectPos].iYPos+=8
					Object[TempObjectPos].XVelocity=0x18000
					Object[TempObjectPos].YVelocity=-0x1C000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],10,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=24
					Object[TempObjectPos].iYPos-=4
					Object[TempObjectPos].XVelocity=-0x18000
					Object[TempObjectPos].YVelocity=-0x1C000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],11,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=8
					Object[TempObjectPos].iYPos+=2
					Object[TempObjectPos].XVelocity=-0xC000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],10,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=8
					Object[TempObjectPos].iYPos+=6
					Object[TempObjectPos].XVelocity=0xC000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],11,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=24
					Object[TempObjectPos].iYPos-=4
					Object[TempObjectPos].XVelocity=0x18000
					Object[TempObjectPos].YVelocity=-0x1C000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x2800
					CreateTempObject(TypeName[BreakGem],2,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=24
					Object[TempObjectPos].iYPos-=8
					Object[TempObjectPos].XVelocity=-0x20000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x3800
					CreateTempObject(TypeName[BreakGem],3,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos-=8
					Object[TempObjectPos].iYPos-=8
					Object[TempObjectPos].XVelocity=-0x10000
					Object[TempObjectPos].YVelocity=-0x28000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x3800
					CreateTempObject(TypeName[BreakGem],4,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=8
					Object[TempObjectPos].iYPos-=8
					Object[TempObjectPos].XVelocity=0x10000
					Object[TempObjectPos].YVelocity=-0x28000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x3800
					CreateTempObject(TypeName[BreakGem],5,Object.XPos,Object.YPos)
					Object[TempObjectPos].iXPos+=24
					Object[TempObjectPos].iYPos-=8
					Object[TempObjectPos].XVelocity=0x20000
					Object[TempObjectPos].YVelocity=-0x20000
					Object[TempObjectPos].State=1
					Object[TempObjectPos].DrawOrder=5
					Object[TempObjectPos].Value1=0x3800
					Object.Type=TypeName[BlankObject]
					switch Object[PlayerObjectPos].Value19
					case 0
						player.score+=100
						break
					case 1
						player.score+=200
						break
					case 2
						player.score+=500
						break
					case 3
					case 4
					case 5
					case 6
					case 7
					case 8
					case 9
					case 10
					case 11
					case 12
					case 13
					case 14
						player.score+=1000
						break
					case 15
						player.score+=0x2710
						break
					endswitch
					CreateTempObject(TypeName[ObjectScore],Object[PlayerObjectPos].Value19,Object.XPos,Object.YPos)
					Object[TempObjectPos].DrawOrder=5
					if Object[PlayerObjectPos].Gravity==GRAVITY_AIR
						if Object[PlayerObjectPos].Value19<15
							Object[PlayerObjectPos].Value19++
						endif
					endif
					PlaySfx(SFXName[BlockBreak],0)
				endif
			else
				PlayerObjectCollision(C_BOX,Object.EntityNo,-24,-16,24,16,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
			endif
		floop
		break
	case 1
		Object.XPos+=Object.XVelocity
		Object.YPos+=Object.YVelocity
		Object.YVelocity+=Object.Value1
		if Object.OutOfBounds==1
			Object.Type=TypeName[BlankObject]
		endif
		break
	endswitch
endsub


sub ObjectDraw
	if Object.State==0
		DrawSpriteFX(0,FX_INK,Object.XPos,Object.YPos)
		DrawSprite(1)
	else
		DrawSprite(Object.PropertyValue)
	endif
endsub


sub ObjectStartup
	LoadSpriteSheet("HPZ/Objects.gif")
	SpriteFrame(-32,-16,64,32,1,223)
	SpriteFrame(-32,1,64,15,115,207)
	SpriteFrame(-8,-8,16,16,115,173)
	SpriteFrame(-8,-8,16,16,132,173)
	SpriteFrame(-8,-8,16,16,149,173)
	SpriteFrame(-8,-8,16,16,166,173)
	SpriteFrame(-8,-8,16,16,115,190)
	SpriteFrame(-8,-8,16,16,132,190)
	SpriteFrame(-8,-8,16,16,149,190)
	SpriteFrame(-8,-8,16,16,166,190)
	SpriteFrame(-4,-4,8,8,183,173)
	SpriteFrame(-4,-4,8,8,183,182)
	SetArrayValue(59,DebugMode_staticVar25,DebugMode_array12)
	SetArrayValue(129,DebugMode_staticVar25,DebugMode_array13)
	SetArrayValue(130,DebugMode_staticVar25,DebugMode_array11)
	DebugMode_staticVar25++
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
