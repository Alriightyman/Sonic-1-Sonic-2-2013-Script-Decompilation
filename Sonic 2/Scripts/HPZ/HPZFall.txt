//--------------------Sonic 1 / Sonic 2 HPZ Fall Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 56: TYPE_HPZFALL




sub ObjectMain
	if Object.State==0
		if recAnimation!=0
			TempValue0=recAnimation
		else
			TempValue0=ANI_WATERSLIDE
			TempValue0<<=16
			TempValue0|=ANI_WATERSLIDE
			TempValue0<<=8
		endif
		PlayerObjectPos=0
		while PlayerObjectPos<PlayerObjectCount
			CreateTempObject(TypeName[HPZFall],0,Object.XPos,Object.YPos)
			Object[TempObjectPos].State=1
			Object[TempObjectPos].Value0=PlayerObjectPos
			Object[TempObjectPos].Direction=TempValue0
			Object[TempObjectPos].Direction&=255
			TempValue0>>=8
			Object[TempObjectPos].Animation=TempValue0
			Object[TempObjectPos].Animation&=255
			TempValue0>>=8
			PlayerObjectPos++
		loop
		Object.Type=TypeName[BlankObject]
	else
		PlayerObjectPos=Object.Value0
		if Object[PlayerObjectPos].Gravity==GRAVITY_GROUND
			Object.Type=TypeName[BlankObject]
		else
			Object[PlayerObjectPos].Direction=Object.Direction
			Object[PlayerObjectPos].Animation=Object.Animation
			if Object[PlayerObjectPos].Animation==ANI_JUMPING
				Object[PlayerObjectPos].State=12
				Object.Type=TypeName[BlankObject]
			endif
			if Object[PlayerObjectPos].Animation==ANI_FLYING
				Object[PlayerObjectPos].State=19
				Object[PlayerObjectPos].Value26=0x800
				Object.Type=TypeName[BlankObject]
			endif
			if Object[PlayerObjectPos].Animation==ANI_GLIDING
				if Object[PlayerObjectPos].Direction==FLIP_X
					Object[PlayerObjectPos].State=20
				else
					Object[PlayerObjectPos].State=21
				endif
				Object.Type=TypeName[BlankObject]
			endif
			if Object[PlayerObjectPos].Animation==ANI_GLIDING_DROP
				Object[PlayerObjectPos].State=22
				Object.Type=TypeName[BlankObject]
			endif
		endif
	endif
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
