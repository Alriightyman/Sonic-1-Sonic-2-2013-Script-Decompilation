//--------------------Sonic 1 / Sonic 2 EggmanBarrier Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 80: TYPE_EGGMANBARRIER




sub ObjectMain
	switch Object.State
	case 0
		GetArrayValue(TempValue0,10,StageSetup_array9)
		TempValue0>>=5
		TempValue0+=128
		Object.Alpha+=4
		if Object.Alpha>=TempValue0
			Object.State=1
		endif
		break
	case 1
		GetArrayValue(Object.Alpha,10,StageSetup_array9)
		Object.Alpha>>=5
		Object.Alpha+=128
		if Object.Value0>0
			Object.Value0--
			if Object.Value0==0
				Object.State=2
			endif
		endif
		break
	case 2
		Object.Alpha-=4
		if Object.Alpha<=0
			Object.Type=TypeName[BlankObject]
		endif
		break
	endswitch
	if Object.PropertyValue==0
		foreach TypeGroup[256],PlayerObjectPos
			TempValue0=Object[PlayerObjectPos].CollisionLeft
			TempValue0<<=16
			TempValue0+=Object[PlayerObjectPos].XPos
			TempValue1=Object.XPos
			TempValue1+=0x80000
			if TempValue0<TempValue1
				Object[PlayerObjectPos].XVelocity=0
				Object[PlayerObjectPos].Speed=0
				Object[PlayerObjectPos].XPos=TempValue1
				TempValue0=Object[PlayerObjectPos].CollisionLeft
				TempValue0<<=16
				Object[PlayerObjectPos].XPos-=TempValue0
			endif
		floop
	else
		foreach TypeGroup[256],PlayerObjectPos
			TempValue0=Object[PlayerObjectPos].CollisionRight
			TempValue0<<=16
			TempValue0+=Object[PlayerObjectPos].XPos
			TempValue1=Object.XPos
			TempValue1-=0x80000
			if TempValue0>TempValue1
				Object[PlayerObjectPos].XVelocity=0
				Object[PlayerObjectPos].Speed=0
				Object[PlayerObjectPos].XPos=TempValue1
				TempValue0=Object[PlayerObjectPos].CollisionRight
				TempValue0<<=16
				Object[PlayerObjectPos].XPos-=TempValue0
			endif
		floop
	endif
endsub


sub ObjectDraw
	DrawSpriteFX(0,FX_INK,Object.XPos,Object.YPos)
endsub


sub ObjectStartup
	CheckStageFolder("Zone11")
	if CheckResult==1
		LoadSpriteSheet("SCZ/Objects.gif")
		SpriteFrame(-8,-64,16,128,294,1)
	else
		LoadSpriteSheet("MBZ/Objects.gif")
		SpriteFrame(-8,-64,16,128,463,1)
	endif
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
