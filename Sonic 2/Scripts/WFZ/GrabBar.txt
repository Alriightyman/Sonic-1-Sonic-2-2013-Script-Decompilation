//--------------------Sonic 1 / Sonic 2 Grab Bar Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 62: TYPE_GRABBAR




sub ObjectMain
	if Object.Value0>0
		Object.Value0--
	endif
	foreach TypeGroup[256],PlayerObjectPos
		if Object[PlayerObjectPos].State!=1
			if Object.Value0==0
				TempValue0=Object[PlayerObjectPos].CollisionTop
				PlayerObjectCollision(C_TOUCH,Object.EntityNo,-24,0,24,8,PlayerObjectPos,-1,TempValue0,1,TempValue0)
				if CheckResult==1
					if Object[PlayerObjectPos].Gravity==GRAVITY_AIR
						Object[PlayerObjectPos].State=1
						Object[PlayerObjectPos].Animation=ANI_HANGING
						Object[PlayerObjectPos].Speed=0
						Object[PlayerObjectPos].XVelocity=0
						Object[PlayerObjectPos].YVelocity=0
						Object[PlayerObjectPos].YPos=Object[PlayerObjectPos].CollisionTop
						Object[PlayerObjectPos].YPos++
						FlipSign(Object[PlayerObjectPos].YPos)
						Object[PlayerObjectPos].YPos<<=16
						Object[PlayerObjectPos].YPos+=Object.YPos
						PlaySfx(SFXName[Catch],0)
					endif
				endif
			endif
		else
			if Object[PlayerObjectPos].JumpPress==1
				Object[PlayerObjectPos].State=12
				Object[PlayerObjectPos].YVelocity=-0x40000
				Object[PlayerObjectPos].Gravity=GRAVITY_AIR
				Object.Value0=8
			endif
			if Object[PlayerObjectPos].State==1
				Object[PlayerObjectPos].YPos=Object[PlayerObjectPos].CollisionTop
				Object[PlayerObjectPos].YPos++
				FlipSign(Object[PlayerObjectPos].YPos)
				Object[PlayerObjectPos].YPos<<=16
				Object[PlayerObjectPos].YPos+=Object.YPos
			endif
		endif
	floop
endsub


sub ObjectDraw
endsub


sub ObjectStartup
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
