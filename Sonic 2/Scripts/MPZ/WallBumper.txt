//--------------------Sonic 1 / Sonic 2 Wall Bumper Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 60: TYPE_WALLBUMPER




sub ObjectMain
	foreach TypeGroup[256],PlayerObjectPos
		CheckEqual(Object[PlayerObjectPos].Gravity,GRAVITY_GROUND)
		TempValue0=CheckResult
		CheckNotEqual(Object[PlayerObjectPos].CollisionMode,CMODE_FLOOR)
		TempValue0&=CheckResult
		if TempValue0==0
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-10,Object.Value0,10,Object.Value1,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
		else
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,-20,Object.Value0,20,Object.Value1,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
		endif
		if CheckResult==1
			if Object.Direction==FLIP_NONE
				Object[PlayerObjectPos].XVelocity=0x80000
			else
				Object[PlayerObjectPos].XVelocity=-0x80000
			endif
			Object[PlayerObjectPos].YVelocity=-0x80000
			Object[PlayerObjectPos].YVelocity-=Object[PlayerObjectPos].Value25
			Object[PlayerObjectPos].Direction=Object.Direction
			Object[PlayerObjectPos].State=12
			Object[PlayerObjectPos].TileCollisions=1
			Object[PlayerObjectPos].Gravity=GRAVITY_AIR
			Object[PlayerObjectPos].Speed=Object[PlayerObjectPos].XVelocity
			Object[PlayerObjectPos].Value1=1
			Object[PlayerObjectPos].CollisionMode=CMODE_FLOOR
			Object[PlayerObjectPos].Pushing=0
			Object[PlayerObjectPos].ControlLock=15
			Object[PlayerObjectPos].Animation=ANI_TWIRL
			Object[PlayerObjectPos].PrevAnimation=ANI_TWIRL
			Object[PlayerObjectPos].Frame=0
			Object[PlayerObjectPos].AnimationSpeed=90
			PlaySfx(SFXName[Spring],0)
		endif
	floop
endsub


sub ObjectDraw
	if Object[0].Type==TypeName[DebugMode]
		TempValue1=Object.PropertyValue
		TempValue1&=112
		if TempValue1==0
			TempValue0=-0x400000
			TempValue1=8
		else
			TempValue0=-0x800000
			TempValue1=16
		endif
		TempValue0+=Object.YPos
		TempValue0+=0x80000
		TempValue4=0
		while TempValue4<TempValue1
			DrawSpriteXY(0,Object.XPos,TempValue0)
			TempValue0+=0x100000
			TempValue4++
		loop
	endif
endsub


sub ObjectStartup
	LoadSpriteSheet("Global/Display.gif")
	SpriteFrame(-8,-8,16,16,93,113)
	foreach TypeName[WallBumper],ArrayPos0
		TempValue0=Object[ArrayPos0].PropertyValue
		TempValue0&=112
		if TempValue0==0
			Object[ArrayPos0].Value0=64
		else
			Object[ArrayPos0].Value0=128
		endif
		Object[ArrayPos0].Value1=Object[ArrayPos0].Value0
		FlipSign(Object[ArrayPos0].Value0)
		Object[ArrayPos0].DrawOrder=5
	floop
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
