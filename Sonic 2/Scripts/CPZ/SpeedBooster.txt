//--------------------Sonic 1 / Sonic 2 Speed Booster Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 52: TYPE_SPEEDBOOSTER

// Function declarations
#function SpeedBooster_Function125
#function SpeedBooster_Function126

#static 0:SpeedBooster_staticVar43


function SpeedBooster_Function125
	DrawSprite(0)
endfunction


function SpeedBooster_Function126
	CreateTempObject(TypeName[SpeedBooster],0,Object.XPos,Object.YPos)
	GetBit(TempValue0,Object.Direction,0)
	if TempValue0==0
		Object[TempObjectPos].Direction=FLIP_NONE
	else
		Object[TempObjectPos].Direction=FLIP_X
	endif
	TempValue0=Object[0].Value17
	TempValue0-=SpeedBooster_staticVar43
	if TempValue0==0
		Object[TempObjectPos].Value0=0x100000
	else
		Object[TempObjectPos].Value0=0xA0000
	endif
	Object[TempObjectPos].DrawOrder=5
endfunction


sub ObjectMain
	if Object.Value1!=0
		Object.Value1--
	endif
	foreach TypeGroup[256],PlayerObjectPos
		PlayerObjectCollision(C_TOUCH,Object.EntityNo,-16,-16,16,16,PlayerObjectPos,0,0,0,0)
		if CheckResult==1
			if Object[PlayerObjectPos].Gravity==GRAVITY_GROUND
				if Object.Value1==0
					Object.Value1=2
					PlaySfx(SFXName[Spring],0)
				endif
				TempValue1=0
				TempValue0=Object.Value0
				if Object.Direction==FLIP_X
					FlipSign(Object.Value0)
					if Object[PlayerObjectPos].Speed>TempValue0
						TempValue1=1
					endif
				else
					if Object[PlayerObjectPos].Speed<TempValue0
						TempValue1=1
					endif
				endif
				if TempValue1==1
					Object[PlayerObjectPos].State=10
					if Object[PlayerObjectPos].Animation!=ANI_JUMPING
						if Object[PlayerObjectPos].Animation!=ANI_RUNNING
							Object[PlayerObjectPos].Animation=ANI_WALKING
						endif
					endif
					Object[PlayerObjectPos].Value1=0
					Object[PlayerObjectPos].ControlLock=0
					Object[PlayerObjectPos].Value14=0
					Object[PlayerObjectPos].ControlLock=15
					Object[PlayerObjectPos].Speed=Object.Value0
					Object[PlayerObjectPos].Direction=Object.Direction
					if Object.Direction==FLIP_X
						FlipSign(Object[PlayerObjectPos].Speed)
					endif
				endif
			endif
		endif
	floop
endsub


sub ObjectDraw
	GetBit(TempValue0,oscillation,1)
	if TempValue0==0
		DrawSprite(0)
	endif
endsub


sub ObjectStartup
	CheckStageFolder("Zone02")
	if CheckResult==1
		LoadSpriteSheet("CPZ/Objects.gif")
		SpriteFrame(-24,-8,48,16,91,25)
	else
		LoadSpriteSheet("MBZ/Objects.gif")
		SpriteFrame(-24,-8,48,16,474,321)
	endif
	foreach TypeName[SpeedBooster],ArrayPos0
		if Object[ArrayPos0].PropertyValue==0
			Object[ArrayPos0].Value0=0x100000
		else
			Object[ArrayPos0].Value0=0xA0000
		endif
		Object[ArrayPos0].DrawOrder=5
	floop
	TempValue0=0
	SpeedBooster_staticVar43=DebugMode_staticVar25
	while TempValue0<2
		SetArrayValue(52,DebugMode_staticVar25,DebugMode_array12)
		SetArrayValue(125,DebugMode_staticVar25,DebugMode_array13)
		SetArrayValue(126,DebugMode_staticVar25,DebugMode_array11)
		DebugMode_staticVar25++
		TempValue0++
	loop
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
