//--------------------Sonic 1 / Sonic 2 Ring Platform Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 62: TYPE_RINGPLATFORM

// Function declarations
#function RingPlatform_Function142
#function RingPlatform_Function143



//Unknown Variables
#static 12:staticVar0x13ECD
#static 0:staticVar0x13ECE
#static 0:staticVar0x13ECF
#static 0:staticVar0x13ED0
#static 0:staticVar0x13ED1
#static 0:staticVar0x13ED2
#static 0:staticVar0x13ED3
#static 0:staticVar0x13ED4
#static 0:staticVar0x13ED5
#static 0:staticVar0x13ED6
#static 0:staticVar0x13ED7
#static 0:staticVar0x13ED8
#static 0:staticVar0x13ED9

function RingPlatform_Function142
	DrawSprite(0)
endfunction


function RingPlatform_Function143
	CreateTempObject(TypeName[RingPlatform],0,Object.XPos,Object.YPos)
	Object[TempObjectPos].DrawOrder=4
	Object[TempObjectPos].Direction=Object.Direction
endfunction


sub ObjectMain
	TempValue0=Object.Angle
	if Object.Direction==FLIP_NONE
		Object.Angle++
	else
		Object.Angle--
	endif
	TempValue6=Object.XPos
	TempValue7=Object.YPos
	foreach TypeGroup[256],PlayerObjectPos
		TempValue0>>=1
		TempValue5=Object.Angle
		TempValue5>>=1
		Cos256(TempValue2,TempValue0)
		TempValue2<<=12
		Sin256(TempValue3,TempValue0)
		TempValue3<<=12
		Cos256(TempValue0,TempValue5)
		TempValue0<<=12
		Sin256(TempValue1,TempValue5)
		TempValue1<<=12
		Object.Value0=Object.XPos
		Object.Value1=Object.YPos
		TempValue4=0
		while TempValue4<6
			PlayerObjectCollision(C_BOX,Object.EntityNo,-8,-8,8,8,PlayerObjectPos,0x10000,0x10000,0x10000,0x10000)
			if CheckResult==1
				TempValue5=Object.Value0
				TempValue5&=-0x10000
				Object.Value2=Object.XPos
				Object.Value2&=-0x10000
				TempValue5-=Object.Value2
				Object[PlayerObjectPos].XPos+=TempValue5
				TempValue5=Object.Value1
				TempValue5&=-0x10000
				Object.Value2=Object.YPos
				Object.Value2&=-0x10000
				TempValue5-=Object.Value2
				Object[PlayerObjectPos].YPos+=TempValue5
			endif
			Object.XPos+=TempValue2
			Object.YPos+=TempValue3
			Object.Value0+=TempValue0
			Object.Value1+=TempValue1
			TempValue4++
		loop
		Object.XPos=TempValue6
		Object.YPos=TempValue7
	floop
endsub


sub ObjectDraw
	TempValue5=Object.Angle
	TempValue5>>=1
	TempValue0=Object.XPos
	TempValue1=Object.YPos
	Cos256(TempValue2,TempValue5)
	TempValue2<<=12
	Sin256(TempValue3,TempValue5)
	TempValue3<<=12
	TempValue4=0
	while TempValue4<6
		DrawSpriteXY(0,TempValue0,TempValue1)
		TempValue0+=TempValue2
		TempValue1+=TempValue3
		TempValue4++
	loop
endsub


sub ObjectStartup
	LoadSpriteSheet("Global/Items.gif")
	foreach TypeName[RingPlatform],ArrayPos0
		Object[ArrayPos0].DrawOrder=4
	floop
	SpriteFrame(-8,-8,16,16,1,1)
	SetArrayValue(62,DebugMode_staticVar25,DebugMode_array12)
	SetArrayValue(142,DebugMode_staticVar25,DebugMode_array13)
	SetArrayValue(143,DebugMode_staticVar25,DebugMode_array11)
	DebugMode_staticVar25++
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
