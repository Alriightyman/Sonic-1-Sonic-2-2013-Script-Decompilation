//--------------------Sonic 1 / Sonic 2 2PVSMenu2 Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 10: TYPE_2PVSMENU2

// Function declarations
#function 2PVSMenu2_Function4
#function 2PVSMenu2_Function5
#function 2PVSMenu2_Function6



function 2PVSMenu2_Function4
	TempValue0=Screen.CenterX
	TempValue0-=Object.Value5
	if Object.Value3==1
		if Object.State==1
			TempValue1=3
		else
			TempValue1=Object.Value4
			TempValue1>>=1
			TempValue1&=1
			TempValue1+=2
		endif
	else
		TempValue1=2
	endif
	Object.Alpha=Object.Value7
	DrawSpriteScreenFX(TempValue1,FX_INK,TempValue0,Object.Value6)
	DrawSpriteScreenFX(4,FX_INK,TempValue0,Object.Value6)
endfunction


function 2PVSMenu2_Function5
	if Object.Value3==2
		if Object.State==1
			TempValue1=3
		else
			TempValue1=Object.Value4
			TempValue1>>=1
			TempValue1&=1
			TempValue1+=2
		endif
	else
		TempValue1=2
	endif
	Object.Alpha=Object.Value8
	DrawSpriteScreenFX(TempValue1,FX_INK,Screen.CenterX,Object.Value6)
	DrawSpriteScreenFX(5,FX_INK,Screen.CenterX,Object.Value6)
endfunction


function 2PVSMenu2_Function6
	TempValue0=Screen.CenterX
	TempValue0+=Object.Value5
	if Object.Value3==3
		if Object.State==1
			TempValue1=3
		else
			TempValue1=Object.Value4
			TempValue1>>=1
			TempValue1&=1
			TempValue1+=2
		endif
	else
		TempValue1=2
	endif
	Object.Alpha=Object.Value9
	DrawSpriteScreenFX(TempValue1,FX_INK,TempValue0,Object.Value6)
	DrawSpriteScreenFX(6,FX_INK,TempValue0,Object.Value6)
endfunction


sub ObjectMain
	switch Object.State
	case 0
		LoadSpriteSheet("LevelSelect/Icons.gif")
		Object.Value1=Object.SpriteSheet
		LoadSpriteSheet("LevelSelect/Text.gif")
		Object.Value2=Object.SpriteSheet
		if Engine.PlatformID==RETRO_STANDARD
			options.physicalControls=1
		endif
		if options.physicalControls==0
			Object.Value3=0
		else
			Object.Value3=1
		endif
		Object.Value5=80
		Object.Value6=120
		Object.Value7=256
		Object.Value8=256
		Object.Value9=256
		Object.InkEffect=INK_ALPHA
		Object.State++
		break
	case 1
		if options.physicalControls==0
			CheckTouchRect(0,0,Screen.XSize,Screen.YSize)
			if CheckResult>-1
				TempValue0=Screen.CenterX
				TempValue0-=Object.Value5
				TempValue0-=32
				TempValue1=TempValue0
				TempValue1+=64
				TempValue2=Object.Value6
				TempValue2-=32
				TempValue3=TempValue2
				TempValue3+=64
				Object.Value3=0
				CheckTouchRect(TempValue0,TempValue2,TempValue1,TempValue3)
				if CheckResult>-1
					Object.Value3=1
				endif
				TempValue0=Screen.CenterX
				TempValue0-=32
				TempValue1=TempValue0
				TempValue1+=64
				CheckTouchRect(TempValue0,TempValue2,TempValue1,TempValue3)
				if CheckResult>-1
					Object.Value3=2
				endif
				TempValue0=Screen.CenterX
				TempValue0+=Object.Value5
				TempValue0-=32
				TempValue1=TempValue0
				TempValue1+=64
				CheckTouchRect(TempValue0,TempValue2,TempValue1,TempValue3)
				if CheckResult>-1
					Object.Value3=3
				endif
				TempValue0=Screen.CenterX
				TempValue0-=24
				TempValue1=TempValue0
				TempValue1+=48
				CheckTouchRect(TempValue0,192,TempValue1,224)
				if CheckResult>-1
					Object.Value3=4
				endif
			else
				switch Object.Value3
				case 1
				case 2
				case 3
					Object.State=2
					Object.Value4=0
					PlaySfx(SFXName[StarPost],0)
					break
				case 4
					Object.State=3
					Object.Value4=0
					PlaySfx(SFXName[MenuBack],0)
					break

				endswitch
			endif
			if Object.State!=2
				if KeyPress.Left==1
					options.physicalControls=1
					Object.Value3=3
				endif
				if KeyPress.Right==1
					options.physicalControls=1
					Object.Value3=1
				endif
				if KeyPress.Up==1
					options.physicalControls=1
					Object.Value3=4
				endif
				if KeyPress.Down==1
					options.physicalControls=1
					Object.Value3=2
				endif
			endif
		else
			if KeyPress.Left==1
				Object.Value3--
				if Object.Value3<1
					Object.Value3=3
				endif
				PlaySfx(SFXName[MenuMove],0)
			endif
			if KeyPress.Right==1
				Object.Value3++
				if Object.Value3>3
					Object.Value3=1
				endif
				PlaySfx(SFXName[MenuMove],0)
			endif
			if KeyPress.Up==1
				if Object.Value3<4
					Object.Value3=4
				else
					Object.Value3=2
				endif
				PlaySfx(SFXName[MenuMove],0)
			endif
			if KeyPress.Down==1
				if Object.Value3<4
					Object.Value3=4
				else
					Object.Value3=2
				endif
				PlaySfx(SFXName[MenuMove],0)
			endif
			if KeyPress.Start==1
				if Object.Value3<4
					Object.State=2
					Object.Value4=0
					PlaySfx(SFXName[StarPost],0)
				else
					Object.State=3
					Object.Value4=0
					PlaySfx(SFXName[MenuBack],0)
				endif
			endif
			if KeyPress.ButtonA==1
				Object.State=2
				Object.Value4=0
				PlaySfx(SFXName[StarPost],0)
			endif
			if KeyPress.ButtonB==1
				Object.State=3
				Object.Value3=4
				Object.Value4=0
				PlaySfx(SFXName[MenuBack],0)
			endif
			if Object.State!=2
				CheckTouchRect(0,0,Screen.XSize,Screen.YSize)
				if CheckResult>-1
					options.physicalControls=0
					Object.Value3=0
				endif
			endif
		endif
		break
	case 2
		switch Object.Value3
		case 1
			Object.Value8-=8
			Object.Value9-=8
			break
		case 2
			Object.Value7-=8
			Object.Value9-=8
			break
		case 3
			Object.Value7-=8
			Object.Value8-=8
			break

		endswitch
		if Object.Value4<32
			Object.Value4++
			Object.Value5=32
			Object.Value5-=Object.Value4
			Object.Value5*=80
			Object.Value5>>=5
		else
			Object.Value4=0
			Object.Value5=0
			Object.Value0=-256
			Object.State=4
		endif
		break
	case 3
		if Object.Value4<32
			Object.Value4++
		else
			Object.Value4=0
			Object.State=5
		endif
		break
	case 4
		if Object.Value0<256
			Object.Value0+=16
			if Object.Value0>0
				SetScreenFade(0,0,0,Object.Value0)
			endif
		else
			Stage.PlayerListPos=Object.Value3
			Stage.PlayerListPos--
			ResetObjectEntity(1,TypeName[2PVSMenu3],0,0,0)
			Object[1].Priority=PRIORITY_ACTIVE
			Object[0].State=1
			Object[0].Value0=384
			SetScreenFade(0,0,0,255)
			EngineCallback(Connect2PVS,vs.gameLength,vs.itemMode)
		endif
		break
	case 5
		if Object.Value0<256
			Object.Value0+=16
			SetScreenFade(0,0,0,Object.Value0)
		else
			ResetObjectEntity(1,TypeName[2PVSMenu1],0,0,0)
			Object[1].Priority=PRIORITY_ACTIVE
			Object[0].State=1
			Object[0].Value0=384
			SetScreenFade(0,0,0,255)
		endif
		break

	endswitch
endsub


sub ObjectDraw
	Object.SpriteSheet=Object.Value1
	DrawSpriteScreenXY(0,Screen.CenterX,17)
	DrawSpriteScreenXY(1,Screen.CenterX,17)
	if Object.State==3
		TempValue0=Object.Value4
		TempValue0>>=1
		TempValue0&=1
		TempValue0+=7
	else
		if options.physicalControls==0
			if Object.Value3==4
				TempValue0=1
			else
				TempValue0=0
			endif
		else
			TempValue0=0
		endif
		TempValue0+=7
	endif
	DrawSpriteScreenXY(TempValue0,Screen.CenterX,210)
	switch Object.Value3
	case 0
	case 1
		CallFunction(2PVSMenu2_Function5)
		CallFunction(2PVSMenu2_Function6)
		CallFunction(2PVSMenu2_Function4)
		break
	case 2
		CallFunction(2PVSMenu2_Function6)
		CallFunction(2PVSMenu2_Function4)
		CallFunction(2PVSMenu2_Function5)
		break
	case 3
		CallFunction(2PVSMenu2_Function5)
		CallFunction(2PVSMenu2_Function4)
		CallFunction(2PVSMenu2_Function6)
		break
	case 4
		CallFunction(2PVSMenu2_Function4)
		CallFunction(2PVSMenu2_Function5)
		CallFunction(2PVSMenu2_Function6)
		if Object.State!=3
			if options.physicalControls==1
				DrawSpriteScreenXY(9,Screen.CenterX,210)
			endif
		endif
		break

	endswitch
endsub


sub ObjectStartup
	LoadSpriteSheet("LevelSelect/Icons.gif")
	LoadSpriteSheet("LevelSelect/Text.gif")
	SpriteFrame(-104,0,96,14,1,249)
	SpriteFrame(8,0,96,14,1,264)
	SpriteFrame(-32,-32,64,64,98,249)
	SpriteFrame(-32,-32,64,64,163,249)
	SpriteFrame(-12,-20,24,40,1,279)
	SpriteFrame(-16,-20,32,40,54,279)
	SpriteFrame(-14,-20,27,40,26,279)
	SpriteFrame(-20,-10,40,20,1,341)
	SpriteFrame(-20,-10,40,20,42,341)
	SpriteFrame(-22,-12,42,22,1,362)
	foreach TypeName[2PVSMenu2],ArrayPos0
		Object[ArrayPos0].Priority=PRIORITY_ACTIVE
	floop
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
