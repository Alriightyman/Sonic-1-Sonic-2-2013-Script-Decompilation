//--------------------Sonic 1 / Sonic 2 StartMessage Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 12: TYPE_STARTMESSAGE




sub ObjectMain
	switch Object.State
	case 0
		options.touchControls=0
		Object.Value1=fadeColor
		Object.Value1>>=16
		Object.Value2=fadeColor
		Object.Value2&=0xFF00
		Object.Value2>>=8
		Object.Value3=fadeColor
		Object.Value3&=255
		if options.vsMode==1
			Object.Value6=0
			Object.Value7=1
			Object.Value0=0
			Object.State++
		else
			Object.Value6=1
			Object.Value7=0
			Object.State=3
			Object.Value0=256
			SetScreenFade(Object.Value1,Object.Value2,Object.Value3,Object.Value0)
		endif
		break
	case 1
		if Object.Value0<15
			Object.Value0++
		else
			EngineCallback(SendEntity,Object.EntityNo,0)
			if options.vsMode==1
				if ReceiveValue==-1
					Object.Value6=1
				else
					EngineCallback(ReceiveEntity,0x400,1)
					Object.Value6=Object[1024].Value7
					ResetObjectEntity(0x400,TypeName[BlankObject],0,0,0)
				endif
			endif
			if Object.Value6==1
				Object.Value0=0
				Object.State++
			endif
		endif
		break
	case 2
		options.touchControls=0
		EngineCallback(SendEntity,Object.EntityNo,0)
		if Object.Value0<30
			Object.Value0++
		else
			Object.Value0=256
			Object.State++
		endif
		break
	case 3
		options.touchControls=0
		Stage.State=STAGE_RUNNING
		Object.State++
		if options.vsMode==1
			CreateTempObject(TypeName[TextMessage],4,0,0)
			Object[TempObjectPos].DrawOrder=5
		endif
		SetScreenFade(Object.Value1,Object.Value2,Object.Value3,Object.Value0)
		PlayMusic(0)
		break
	case 4
		options.touchControls=0
		if Object.Value0>0
			Object.Value0-=8
		else
			if options.vsMode==1
				Object.YPos=-75
			else
				Object.YPos=-15
			endif
			Object.State++
		endif
		SetScreenFade(Object.Value1,Object.Value2,Object.Value3,Object.Value0)
		break
	case 5
		options.touchControls=0
		if Object.YPos<108
			Object.YPos++
		else
			Object.State++
		endif
		break
	case 6
		options.touchControls=0
		if Object.Value0<30
			Object.Value0++
		else
			Object.Value0=0
			TempValue0=-0x380000
			TempValue1=Object.YPos
			TempValue1<<=16
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=1
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=72
			TempValue0+=0x180000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=2
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=48
			TempValue0+=0x100000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=3
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=24
			TempValue0+=0x100000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=4
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=0
			TempValue0+=0x100000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=5
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=-24
			TempValue0+=0x100000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=6
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=-48
			TempValue0+=0x180000
			CreateTempObject(TypeName[StartMessage],0,TempValue0,TempValue1)
			Object[TempObjectPos].Frame=7
			Object[TempObjectPos].State=7
			Object[TempObjectPos].Angle=-72
			Object.State=9
		endif
		break
	case 7
		Object.Angle&=511
		Object.Scale=512
		Object.Speed=-0x10000
		Object.Value4=16
		Rand(Object.Value5,32)
		Object.Value5-=16
		Object.State++
		break
	case 8
		Object.XPos+=Object.XVelocity
		Object.YPos+=Object.YVelocity
		Object.Scale+=Object.Value4
		Object.Speed-=0x8000
		Object.Value4++
		Object.Rotation+=Object.Value5
		Object.Rotation&=511
		Cos(Object.YVelocity,Object.Angle)
		Object.YVelocity*=Object.Speed
		Object.YVelocity>>=9
		Sin(Object.XVelocity,Object.Angle)
		Object.XVelocity*=Object.Speed
		Object.XVelocity>>=9
		if Object.Value0<120
			Object.Value0++
		else
			Object.Type=TypeName[BlankObject]
		endif
		break
	case 9
		if Object.Value0<40
			Object.Value0++
		else
			if options.vsMode==0
				CreateTempObject(TypeName[TextMessage],2,0,0)
			else
				CreateTempObject(TypeName[TextMessage],5,0,0)
			endif
			Object[TempObjectPos].DrawOrder=5
			GetArrayValue(Object[TempObjectPos].Value4,SpecialSetup_staticVar3,SpecialSetup_staticVar4)
			ResetObjectEntity(Object.EntityNo,TypeName[BlankObject],0,0,0)
		endif
		break
	endswitch
endsub


sub ObjectDraw
	switch Object.State
	case 0
	case 1
	case 2
		DrawRect(0,0,Screen.XSize,Screen.YSize,Object.Value1,Object.Value2,Object.Value3,255)
		if options.vsMode==1
			DrawSpriteScreenXY(8,Screen.XSize,Screen.YSize)
		endif
		break
	case 5
	case 6
		DrawSpriteScreenXY(0,Screen.CenterX,Object.YPos)
		break
	case 7
	case 8
		TempValue0=Object.XPos
		TempValue0>>=16
		TempValue0+=Screen.CenterX
		TempValue1=Object.YPos
		TempValue1>>=16
		DrawSpriteScreenFX(Object.Frame,FX_ROTOZOOM,TempValue0,TempValue1)
		break
	case 3
	case 4
	endswitch
endsub


sub ObjectStartup
	LoadSpriteSheet("Special/Objects.gif")
	SpriteFrame(-72,-15,144,30,367,91)
	SpriteFrame(-16,-15,32,30,367,91)
	SpriteFrame(-8,-15,16,30,399,91)
	SpriteFrame(-8,-15,16,30,415,91)
	SpriteFrame(-8,-15,16,30,431,91)
	SpriteFrame(-8,-15,16,30,447,91)
	SpriteFrame(-8,-15,16,30,463,91)
	SpriteFrame(-16,-15,32,30,479,91)
	if vs.playerID==0
		SpriteFrame(-160,-16,136,7,326,369)
	else
		SpriteFrame(-160,-16,136,7,326,361)
	endif
	if options.vsMode==1
		Stage.State=STAGE_PAUSED
	endif
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
