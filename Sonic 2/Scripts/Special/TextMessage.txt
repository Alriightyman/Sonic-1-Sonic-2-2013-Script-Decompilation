//--------------------Sonic 1 / Sonic 2 TextMessage Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 13: TYPE_TEXTMESSAGE

// Function declarations
#function TextMessage_Function12
#function TextMessage_Function13



function TextMessage_Function12
	GetTextInfo(Object.Value3,MENU_1,TEXTINFO_TEXTSIZE,Object.Value1,0)
	Object.Value2=Object.Value3
	Object.Value2<<=2
	FlipSign(Object.Value2)
	Object.Value2+=Screen.CenterX
	Object.Value2+=4
	TempValue0=0
	while Object.Value3>0
		GetTextInfo(TempValue1,MENU_1,TEXTINFO_TEXTDATA,Object.Value1,TempValue0)
		switch TempValue1
		case 33
			DrawSpriteScreenXY(37,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 35
			TempValue2=Object.Value4
			TempValue2/=100
			DrawSpriteScreenXY(TempValue2,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 36
			TempValue2=Object.Value4
			TempValue2%=100
			TempValue2/=10
			DrawSpriteScreenXY(TempValue2,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 37
			TempValue2=Object.Value4
			TempValue2%=10
			DrawSpriteScreenXY(TempValue2,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 38
			DrawSpriteScreenXY(38,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 46
			DrawSpriteScreenXY(36,Object.Value2,Object.YPos)
			Object.Value2+=8
			break
		case 34
		case 39
		case 40
		case 41
		case 42
		case 43
		case 44
		case 45
		case 47
		default
			Object.Frame=0
			if TempValue1>64
				if TempValue1<91
					Object.Frame=TempValue1
					Object.Frame-=55
				endif
			endif
			if TempValue1>96
				if TempValue1<123
					Object.Frame=TempValue1
					Object.Frame-=87
				endif
			endif
			if Object.Frame>0
				DrawSpriteScreenXY(Object.Frame,Object.Value2,Object.YPos)
			endif
			Object.Value2+=8
		endswitch
		TempValue0++
		Object.Value3--
	loop
endfunction


function TextMessage_Function13
	GetTextInfo(Object.Value3,MENU_1,TEXTINFO_TEXTSIZE,Object.Value1,0)
	Object.Value2=Object.Value3
	Object.Value2<<=2
	FlipSign(Object.Value2)
	Object.Value2+=4
	Object.Value2<<=16
	TempValue0=0
	TempValue3=Object.YPos
	TempValue3<<=16
	Object.Value5=224
	Object.Value5/=Object.Value3
	while Object.Value3>0
		GetTextInfo(TempValue1,MENU_1,TEXTINFO_TEXTDATA,Object.Value1,TempValue0)
		Object.Frame=255
		switch TempValue1
		case 33
			Object.Frame=37
			break
		case 35
			TempValue2=Object.Value4
			TempValue2/=100
			Object.Frame=TempValue2
			break
		case 36
			TempValue2=Object.Value4
			TempValue2%=100
			TempValue2/=10
			Object.Frame=TempValue2
			break
		case 37
			TempValue2=Object.Value4
			TempValue2%=10
			Object.Frame=TempValue2
			break
		case 38
			Object.Frame=38
			break
		case 46
			Object.Frame=36
			break
		case 34
		case 39
		case 40
		case 41
		case 42
		case 43
		case 44
		case 45
		case 47
		default
			if TempValue1>64
				if TempValue1<91
					Object.Frame=TempValue1
					Object.Frame-=55
				endif
			endif
			if TempValue1>96
				if TempValue1<123
					Object.Frame=TempValue1
					Object.Frame-=87
				endif
			endif
		endswitch
		if Object.Frame<255
			CreateTempObject(TypeName[TextMessage],9,Object.Value2,TempValue3)
			Object[TempObjectPos].DrawOrder=5
			Object[TempObjectPos].Frame=Object.Frame
			if Object.Value8==0
				Object[TempObjectPos].Angle=Object.Angle
			else
				Object[TempObjectPos].Angle=Object.Angle
				FlipSign(Object[TempObjectPos].Angle)
				Object[TempObjectPos].Angle+=256
				Object[TempObjectPos].Angle&=511
			endif
			Object[TempObjectPos].Speed=-0x10000
			Object[TempObjectPos].Value6=16
			Rand(Object[TempObjectPos].Value7,32)
			Object[TempObjectPos].Value7-=16
		endif
		Object.Angle-=Object.Value5
		Object.Angle&=511
		Object.Value2+=0x80000
		TempValue0++
		Object.Value3--
	loop
endfunction


sub ObjectMain
	switch Object.PropertyValue
	case 0
	case 4
		if Object.Value0<120
			Object.Value0++
		else
			Object.Angle=96
			CallFunction(TextMessage_Function13)
			ResetObjectEntity(Object.EntityNo,TypeName[BlankObject],0,0,0)
		endif
		break
	case 1
		if Object.Value0<120
			Object.Value0++
		else
			Object.Value8=0
			Object.Value1=1
			Object.YPos=116
			Object.Angle=96
			CallFunction(TextMessage_Function13)
			Object.Value8=1
			Object.YPos+=22
			Object.Value1=2
			Object.Angle=96
			CallFunction(TextMessage_Function13)
			ResetObjectEntity(Object.EntityNo,TypeName[BlankObject],0,0,0)
		endif
		break
	case 2
	case 5
		if Object.Value0<90
			Object.Value0++
		else
			Object.Angle=96
			CallFunction(TextMessage_Function13)
			ResetObjectEntity(Object.EntityNo,TypeName[BlankObject],0,0,0)
		endif
		break
	case 3
		if stage.player2Enabled==1
			TempValue0=Object[2].Value0
			TempValue0+=Object[3].Value0
		else
			TempValue0=Object[2].Value0
		endif
		GetArrayValue(TempValue1,SpecialSetup_staticVar3,SpecialSetup_staticVar4)
		if TempValue0<TempValue1
			Object.AnimationTimer=0
		else
			if Object.AnimationTimer<30
				Object.AnimationTimer++
			endif
		endif
		CheckLower(TempValue0,TempValue1)
		TempValue2=CheckResult
		CheckLower(Object.AnimationTimer,30)
		TempValue2|=CheckResult
		if TempValue2==1
			GetBit(Object.Visible,Object.Value0,2)
			Object.Value0++
			Object.Value0&=7
			Object.Value4=TempValue1
			Object.Value4-=TempValue0
			if Object.Value4<0
				Object.Value4=0
			endif
		else
			Object.Visible=0
		endif
		break
	case 6
	case 7
	case 8
		if Object.Value0<90
			Object.Value0++
		else
			Object.Angle=96
			CallFunction(TextMessage_Function13)
			ResetObjectEntity(Object.EntityNo,TypeName[BlankObject],0,0,0)
			if SpecialSetup_staticVar3<3
				Object[2].Value0=0
				Object[3].Value0=0
			endif
		endif
		break
	case 9
		Object.XPos+=Object.XVelocity
		Object.YPos+=Object.YVelocity
		Object.Scale+=Object.Value6
		Object.Rotation+=Object.Value7
		Object.Rotation&=511
		Object.Speed-=0x8000
		Object.Value6++
		Cos(Object.YVelocity,Object.Angle)
		Object.YVelocity*=Object.Speed
		Object.YVelocity>>=9
		Sin(Object.XVelocity,Object.Angle)
		Object.XVelocity*=Object.Speed
		Object.XVelocity>>=9
		if Object.Value0<120
			Object.Value0++
		else
			Object.Type=TypeName[BlankObject]
		endif
		break
	endswitch
endsub


sub ObjectDraw
	switch Object.PropertyValue
	case 0
		Object.YPos=116
		Object.Value1=0
		CallFunction(TextMessage_Function12)
		break
	case 1
		Object.Value1=1
		Object.YPos=116
		CallFunction(TextMessage_Function12)
		Object.YPos+=22
		Object.Value1=2
		CallFunction(TextMessage_Function12)
		break
	case 2
		Object.YPos=116
		if Object.Value4>99
			Object.Value1=5
			CallFunction(TextMessage_Function12)
		else
			if Object.Value4>9
				Object.Value1=4
				CallFunction(TextMessage_Function12)
			else
				Object.Value1=3
				CallFunction(TextMessage_Function12)
			endif
		endif
		break
	case 3
		if Object.Visible==1
			Object.YPos=64
			if Object.Value4>99
				Object.Value1=9
				CallFunction(TextMessage_Function12)
			else
				if Object.Value4>9
					Object.Value1=8
					CallFunction(TextMessage_Function12)
				else
					if Object.Value4==1
						Object.Value1=6
						CallFunction(TextMessage_Function12)
					else
						Object.Value1=7
						CallFunction(TextMessage_Function12)
					endif
				endif
			endif
		endif
		break
	case 4
		Object.YPos=116
		Object.Value1=10
		CallFunction(TextMessage_Function12)
		break
	case 5
		Object.YPos=116
		Object.Value1=11
		CallFunction(TextMessage_Function12)
		break
	case 6
		Object.YPos=116
		Object.Value1=12
		CallFunction(TextMessage_Function12)
		break
	case 7
		Object.YPos=116
		Object.Value1=13
		CallFunction(TextMessage_Function12)
		break
	case 8
		Object.YPos=68
		Object.Value1=14
		CallFunction(TextMessage_Function12)
		break
	case 9
		TempValue0=Object.XPos
		TempValue0>>=16
		TempValue0+=Screen.CenterX
		TempValue1=Object.YPos
		TempValue1>>=16
		DrawSpriteScreenFX(Object.Frame,FX_ROTOZOOM,TempValue0,TempValue1)
		break
	endswitch
endsub


sub ObjectStartup
	LoadSpriteSheet("Special/Objects.gif")
	SpriteFrame(-4,-8,8,15,291,42)
	SpriteFrame(-4,-8,8,15,300,42)
	SpriteFrame(-4,-8,8,15,309,42)
	SpriteFrame(-4,-8,8,15,318,42)
	SpriteFrame(-4,-8,8,15,327,42)
	SpriteFrame(-4,-8,8,15,336,42)
	SpriteFrame(-4,-8,8,15,345,42)
	SpriteFrame(-4,-8,8,15,354,42)
	SpriteFrame(-4,-8,8,15,363,42)
	SpriteFrame(-4,-8,8,15,372,42)
	SpriteFrame(-4,-8,8,15,291,26)
	SpriteFrame(-4,-8,8,15,300,26)
	SpriteFrame(-4,-8,8,15,309,26)
	SpriteFrame(-4,-8,8,15,318,26)
	SpriteFrame(-4,-8,8,15,327,26)
	SpriteFrame(-4,-8,8,15,336,26)
	SpriteFrame(-4,-8,8,15,345,26)
	SpriteFrame(-4,-8,8,15,354,26)
	SpriteFrame(-4,-8,8,15,363,26)
	SpriteFrame(-4,-8,8,15,372,26)
	SpriteFrame(-4,-8,8,15,381,26)
	SpriteFrame(-4,-8,8,15,390,26)
	SpriteFrame(-4,-8,8,15,399,26)
	SpriteFrame(-4,-8,8,15,408,26)
	SpriteFrame(-4,-8,8,15,417,26)
	SpriteFrame(-4,-8,8,15,426,26)
	SpriteFrame(-4,-8,8,15,435,26)
	SpriteFrame(-4,-8,8,15,444,26)
	SpriteFrame(-4,-8,8,15,453,26)
	SpriteFrame(-4,-8,8,15,462,26)
	SpriteFrame(-4,-8,8,15,471,26)
	SpriteFrame(-4,-8,8,15,480,26)
	SpriteFrame(-4,-8,8,15,381,42)
	SpriteFrame(-4,-8,8,15,390,42)
	SpriteFrame(-4,-8,8,15,399,42)
	SpriteFrame(-4,-8,8,15,408,42)
	SpriteFrame(-4,-8,8,15,489,26)
	SpriteFrame(-4,-8,8,15,498,26)
	SpriteFrame(-12,-8,24,15,417,42)
	SetupMenu(MENU_1,0,3,1)
	AddMenuEntry(MENU_1,"COOL!",0)
	AddMenuEntry(MENU_1,"NOT ENOUGH",0)
	AddMenuEntry(MENU_1,"RINGS ... ",0)
	AddMenuEntry(MENU_1,"GET % RINGS!",0)
	AddMenuEntry(MENU_1,"GET $% RINGS!",0)
	AddMenuEntry(MENU_1,"GET #$% RINGS!",0)
	AddMenuEntry(MENU_1,"% RING TO GO!",0)
	AddMenuEntry(MENU_1,"% RINGS TO GO!",0)
	AddMenuEntry(MENU_1,"$% RINGS TO GO!",0)
	AddMenuEntry(MENU_1,"#$% RINGS TO GO!",0)
	AddMenuEntry(MENU_1,"PLAYER & PLAYER",0)
	AddMenuEntry(MENU_1,"MOST RINGS WINS!",0)
	AddMenuEntry(MENU_1,"PLAYER ONE WINS!",0)
	AddMenuEntry(MENU_1,"PLAYER TWO WINS!",0)
	AddMenuEntry(MENU_1,"TIE!",0)
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
