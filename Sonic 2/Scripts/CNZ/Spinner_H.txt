//--------------------Sonic 1 / Sonic 2 Spinner H Script--------------------//
//--------Scripted by Christian Whitehead 'The Taxman' & Simon Thomley 'Stealth'--------//
//-----------------Unpacked By Rubberduckycooly's Script Unpacker-----------------------//

//-------Aliases-------//
#alias 65: TYPE_SPINNERH




sub ObjectMain
	foreach TypeGroup[256],PlayerObjectPos
		CheckEqual(Object[PlayerObjectPos].State,28)
		TempValue0=CheckResult
		CheckEqual(Object[PlayerObjectPos].State,25)
		TempValue0|=CheckResult
		if TempValue0==0
			PlayerObjectCollision(C_TOUCH,Object.EntityNo,Object.Value0,-12,Object.Value1,12,PlayerObjectPos,0,0,0,0)
			if CheckResult==1
				switch Object.Direction
				case 0
					if Object[PlayerObjectPos].YVelocity>0
						if Object[PlayerObjectPos].Animation!=ANI_JUMPING
							if Object[PlayerObjectPos].State!=97
								PlaySfx(SFXName[Rolling],0)
							endif
						endif
						if Object[PlayerObjectPos].State==20
							FlipSign(Object[PlayerObjectPos].Speed)
						endif
						Object[PlayerObjectPos].State=97
						Object[PlayerObjectPos].Animation=ANI_JUMPING
						if Object[PlayerObjectPos].Value34==1
							Object[PlayerObjectPos].Value34=0
						endif
						Object[PlayerObjectPos].Value35=0
					else
						CheckEqual(Object[PlayerObjectPos].State,97)
						TempValue0=CheckResult
						CheckEqual(Object[PlayerObjectPos].State,98)
						TempValue0|=CheckResult
						if TempValue0==1
							Object[PlayerObjectPos].State=14
							Object[PlayerObjectPos].Animation=ANI_JUMPING
						endif
					endif
					break
				case 1
					if Object[PlayerObjectPos].YVelocity<0
						if Object[PlayerObjectPos].Animation!=ANI_JUMPING
							if Object[PlayerObjectPos].State!=97
								PlaySfx(SFXName[Rolling],0)
							endif
						endif
						if Object[PlayerObjectPos].State==20
							FlipSign(Object[PlayerObjectPos].Speed)
						endif
						Object[PlayerObjectPos].State=97
						Object[PlayerObjectPos].Animation=ANI_JUMPING
						if Object[PlayerObjectPos].Value34==1
							Object[PlayerObjectPos].Value34=0
						endif
						Object[PlayerObjectPos].Value35=0
					else
						CheckEqual(Object[PlayerObjectPos].State,97)
						TempValue0=CheckResult
						CheckEqual(Object[PlayerObjectPos].State,98)
						TempValue0|=CheckResult
						if TempValue0==1
							Object[PlayerObjectPos].State=14
							Object[PlayerObjectPos].Animation=ANI_JUMPING
						endif
					endif
					break
				endswitch
			endif
		endif
	floop
endsub


sub ObjectStartup
	LoadSpriteSheet("Global/Display.gif")
	SpriteFrame(-8,-8,16,16,127,113)
	SpriteFrame(-8,-8,16,16,144,113)
	foreach TypeName[SpinnerH],ArrayPos0
		TempValue0=Object[ArrayPos0].PropertyValue
		TempValue0&=3
		TempValue0+=2
		Object[ArrayPos0].Value0=1
		Object[ArrayPos0].Value0<<=TempValue0
		Object[ArrayPos0].Value0<<=3
		Object[ArrayPos0].Value1=Object[ArrayPos0].Value0
		FlipSign(Object[ArrayPos0].Value0)
		GetBit(Object[ArrayPos0].Direction,Object[ArrayPos0].PropertyValue,2)
	floop
endsub


sub ObjectDraw
	if Object[0].Type==TypeName[DebugMode]
		TempValue1=Object.PropertyValue
		TempValue1&=3
		TempValue1+=2
		TempValue0=1
		TempValue0<<=TempValue1
		TempValue1=TempValue0
		TempValue0<<=19
		FlipSign(TempValue0)
		TempValue0+=Object.XPos
		TempValue0+=0x80000
		GetBit(TempValue2,Object.PropertyValue,2)
		TempValue3=0
		while TempValue3<TempValue1
			DrawSpriteXY(TempValue2,TempValue0,Object.YPos)
			TempValue0+=0x100000
			TempValue3++
		loop
		if TempValue1==0
			DrawSprite(TempValue2)
		endif
	endif
endsub

sub RSDK
	LoadSpriteSheet("Global/Display.gif")
	SetEditorIcon(Icon0,SingleIcon,-16,-16,32,32,1,143)
endsub
